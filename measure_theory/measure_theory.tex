% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames*,x11names*}{xcolor}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Lebesgue Measure \& Integration},
  pdfauthor={Kexing Ying},
  colorlinks=true,
  linkcolor=Maroon,
  filecolor=Maroon,
  citecolor=Blue,
  urlcolor=red,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin = 1.5in]{geometry}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{tikz}
\usepackage{physics}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{esint}
\usepackage[ruled,vlined]{algorithm2e}
\theoremstyle{definition}
\newtheorem{theorem}{Theorem}
\newtheorem{prop}{Proposition}
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem*{remark}{Remark}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{lemma}{Lemma}[section]
\newcommand{\diag}{\mathop{\mathrm{diag}}}
\newcommand{\Arg}{\mathop{\mathrm{Arg}}}
\newcommand{\hess}{\mathop{\mathrm{Hess}}}

\title{Lebesgue Measure \& Integration}
\author{Kexing Ying}
\date{January 11, 2021}

\begin{document}
\maketitle

{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\newpage

\hypertarget{motivation}{%
\section{Motivation}\label{motivation}}

We recall from \textbf{Analysis I} the definition of the Darboux
integral. While this notion of integration was sufficient for our use
case last year, as we shall see, there are some limitations with this
notion of integration. These limitations will be addressed by the means
of measure theory.

\begin{definition}[Darboux Integrable]
  A function \(f : [a, b] \to \mathbb{R}\) is called Darboux integrable if for 
  any partition \(\mathcal{P} = \{a = t_0 < t_1 < \cdots < t_{n - 1} < t_n = b \}\)
  for some \(n \ge 1\) if \([a, b]\), by defining the lower and upper Darboux sums, 
  \[L(f, \mathcal{P}) = \sum_{i = 1}^n (t_i - t_{i - 1}) \inf_{t \in [t_{i-1}, t_i]} f(t),\]
  and
  \[U(f, \mathcal{P}) = \sum_{i = 1}^n (t_i - t_{i - 1}) \sup_{t \in [t_{i-1}, t_i]} f(t),\]
  one has 
  \[\sup_{\mathcal{P}} L(f, \mathcal{P}) = \inf_{\mathcal{P}} U(f, \mathcal{P}).\]
  If this is the case we define the integral of \(f\) over \([a, b]\) to be this 
  value, i.e. 
  \[\int_a^b f := \sup_{\mathcal{P}} L(f, \mathcal{P}) = \inf_{\mathcal{P}} U(f, \mathcal{P}).\]
\end{definition}

Many functions are Darboux integrable and in fact, as demonstrated last
year, all functions in \(C_{pw}^\circ([a, b])\), that is piecewise
continuous functions on \([a, b]\) are Darboux integrable. Nonetheless,
however, the class of Darboux integrable functions is also rather
limited.

Consider the Dirichlet function \[\mathbf{1}_{\mathbb{Q}}(x) := 
  \begin{cases}
    1, \hspace{2mm} x \in \mathbb{Q};\\
    0, \hspace{2mm} x \in \mathbb{R}\setminus\mathbb{Q}.
  \end{cases}\] That is, the indicator function for \(\mathbb{Q}\). We
see that \(\mathbf{1}_\mathbb{Q}\) is not Darboux integrable since both
\(\mathbb{Q}\) and \(\mathbb{R}\setminus\mathbb{Q}\) are dense in
\(\mathbb{R}\) and so, for any partition \(\mathcal{P}\) of \([a, b]\),
\(L(\mathbf{1}_\mathbb{Q}, \mathcal{P}) = 0\) while
\(U(\mathbf{1}_\mathbb{Q}, \mathcal{P}) = 1\). This is not ideal, since,
as \(\mathbb{Q}\) is countable while \(\mathbb{R}\setminus\mathbb{Q}\)
is not, we intuitively expect that a satisfactory theory of integration
would assign \(\int_a^b \mathbf{1}_\mathbb{Q} = 0\).

Moreover, by defining
\(P = (q_n)_{n \in \mathbb{N}} \subseteq \mathbb{Q}\) be some
enumeration of \(\mathbb{Q} \cap [a, b]\), we can define the following
sequence of functions, \[f_n(x) := 
  \begin{cases}
    1, \hspace{2mm} x \in \{q_0, \cdots, q_n\};\\
    0, \hspace{2mm} \text{otherwise}. 
  \end{cases}\] It is not difficult to see that \(\int_a^b f_n = 0\) for
all \(n\) and \(f_n \to \mathbf{1}_\mathbb{Q}\) pointwise. However, this
implies
\[0 = \lim_{n \to \infty} \int_a^b f_n \neq \int_a^b \lim_{n \to \infty} f_n = 
  \int_a^b \mathbf{1}_\mathbb{Q},\] and in fact, the right hand side is
not even defined (as \(\mathbf{1}_\mathbb{Q}\) is not Darboux
integrable)!

To solve this issue we will introduce the notion of the Lebesgue measure
and furthermore, its associated Lebesgue integral which extends our
Darboux integral such that it has the ``nice'' properties we desire.

We will in this course also look at \(L^p\) spaces. From the perspective
of analysis, it is often convenient to work in Banach spaces (complete
normed vector spaces) such that we can utilise many existing theorems we
have proved in \textbf{Analysis II}, e.g.~Banach's fixed point theorem.
For instance, one can endow \(C_{pw}^\circ([a, b])\) with the
(semi-)norm \[\|f\|_{L^1} := \int_a^b \left| f \right|. \] Then, by
considering the aforementioned sequence
\((f_n) \subseteq C_{pw}^\circ([a, b])\), one can easily show that
\((f_n)\) is a Cauchy sequence with respect to \(\| \cdot \|_{L^1}\).
However, \(f_n \to \mathbf{1}_\mathbb{Q}\) pointwise. This motivates us
to introduce the Banach space \(L^1([a, b])\) of integrable functions,
and more generally, \(L^p\)-spaces later in the course.

Lastly, as we have seen within last term's probability module, measure
theory lays below as the foundations for probability theory. As a quick
reminder, we recall that a probability space is a special type of
measure space and random variables defined on these probability spaces
are simply measurable functions to \(\mathbb{R}\) (or more exotic
fields). This can be interpreted with connotations to real world
situations in several ways.

\newpage

\hypertarget{measures-and-measure-spaces}{%
\section{Measures and Measure
Spaces}\label{measures-and-measure-spaces}}

\hypertarget{algebra-sigma-algebra-and-measures}{%
\subsection{\texorpdfstring{Algebra, \(\sigma\)-Algebra and
Measures}{Algebra, \textbackslash sigma-Algebra and Measures}}\label{algebra-sigma-algebra-and-measures}}

As we would like an adequate theory to assign a notion of ``size'' on
sets, we need to construct a function from a set of sets to
\(\overline{\mathbb{R}^+_0}\). To achieve this, the natural idea is to
construct a function with domain being the power set, however, this is
not necessarily always possible or meaningful. Thus, instead of
assigning every subset of some set a size, we only look at some
collection of ``nice'' sets.

\begin{definition}[Algebra]
  Let \(X\) be some set and suppose we denote \(\mathcal{X}\) for the power set of \(X\),
  then a family \(\mathcal{A} \subseteq \mathcal{P}(X)\) is called an algebra 
  over \(X\) if 
  \begin{itemize}
    \item \(X \in \mathcal{A}\);
    \item for all \(A \in \mathcal{A}\), \(A^c = X \setminus A \in \mathcal{A}\);
    \item if \((A_k)_{i = 1}^n\) is a finite sequence of sets in \(\mathcal{A}\), 
      then \(\bigcup_{k = 1}^n A_k \in \mathcal{A}\).
  \end{itemize}
\end{definition}

\begin{definition}[\(\sigma\)-algebra]
  Let \(X\) be a set, then a \(\sigma\)-algebra \(\mathcal{A}\) on \(X\) is an 
  algebra on \(X\) such that \(\mathcal{A}\) is closed under countable unions, 
  i.e. if \((A_k)_{k = 1}^\infty\) is a sequence of sets in \(\mathcal{A}\), 
  then \(\bigcup_{k = 1}^\infty A_k \in \mathcal{A}\).
\end{definition}

As \(\sigma\)-algebras (and algebras) are simply sets of sets, there is
an induced order on \(\sigma\)-algebras by \(\subseteq\). If there are
two \(\sigma\)-algebras \(\mathcal{A}, \mathcal{B}\) such that
\(\mathcal{A} \subseteq \mathcal{B}\), then we say \(\mathcal{A}\) is
coarser than \(\mathcal{B}\).

Trivially, we find \(\{\varnothing, X\}\) is a \(\sigma\)-algebra.
Indeed, this is the coarsest \(\sigma\)-algebra. Furthermore, given a
set \(X\) and a subset \(A \subseteq X\), we have
\(\{\varnothing, A, A^c, X\}\) is also a \(\sigma\)-algebra.

While every \(\sigma\)-algebra is also an algebra, the converse is not
true. An counter-example of this is by consider the algebra
\[\mathcal{A} := \{\varnothing\} \cup \left\{ U \mid \exists \bigcup_{k = 1}^m (a_k, b_k], 
  m \ge 1, 0 \le a_k < b_k \le 1 \right\},\] on \(X = (0, 1]\). We see
that \(\mathcal{A}\) is an algebra (since
\((a, b]^c = (0, a] \cup (b, 0]\)) however \(\mathcal{A}\) is not a
\(\sigma\)-algebra on \(X\) since we can define the sequence
\(A_k = (0, 1 - 1 / k] \in \mathcal{A}\) but
\(\bigcup_k A_k = (0, 1) \not\in \mathcal{A}\).

\begin{prop}
  Let \(\mathcal{F}\) be an arbitrary collection of \(\sigma\)-algebra (or algebras) 
  over \(X\). Then the intersections 
  \[\bigcap \mathcal{F} := \bigcap_{\mathcal{A} \in \mathcal{F}} \mathcal{A},\]
  is a \(\sigma\)-algebra (or algebra).
\end{prop}
\proof

Straight forward by definition. \qed

With this, we have a notion of infimum on \(\sigma\)-algebras and hence,
we can also define a notion closure.

\begin{definition}[\(\sigma\)-algebra Generated by a set]
  Let \(\mathcal{C} \subseteq \mathcal{P}(X)\), then 
  \[\sigma(\mathcal{C}) := \bigcap \{\mathcal{A} \mid \mathcal{C} \subseteq \mathcal{A} 
    \wedge \mathcal{A} \in \mathcal{F}\},\]
  where \(\mathcal{F}\) is the set of all \(\sigma\)-algebras on \(X\).
\end{definition}

As previously shown, \(\sigma(\mathcal{C})\) is a intersection of
\(\sigma\)-algebras, and so the name suggests, the \(\sigma\)-algebra
generated by \(\mathcal{C}\) is the smallest \(\sigma\)-algebra
containing \(\mathcal{C}\). Indeed, we find
\(\sigma(\varnothing) = \{\varnothing, X\}\) and
\(\sigma(A) = \{\varnothing, A, A^c, X\}\). Moreover, we see that
\(\mathcal{C}\) is a \(\sigma\)-algebra if and only if
\(\sigma(\mathcal{C}) = \mathcal{C}\).

\begin{definition}[Borel \(\sigma\)-algebra]
  If \((X, \mathcal{T})\) is a topological space, then the Borel \(\sigma\)-algebra 
  over \(X\) is 
  \[B(X) := \sigma(\mathcal{T}).\]
\end{definition}

Unlike topologies, the unions and intersections in a \(\sigma\)-algebra
is treated symmetrically.

\begin{prop}
  If \(\mathcal{A}\) is a \(\sigma\)-algebra, then if \((A_k)_{k = 1}^\infty\) is 
  a sequence of sets in \(\mathcal{A}\), then 
  \[\bigcap_{k = 1}^\infty A_k \in \mathcal{A}.\]
\end{prop}
\proof

By considering de Morgen's identity, we have
\(\bigcap_{k = 1}^\infty A_k =  (\bigcup_{k = 1}^\infty A_k^c)^c\). So,
since \(\bigcup_{k = 1}^\infty A_k^c \in  \mathcal{A}\) as each
component is, \(\bigcup_{k = 1}^\infty A_k^c)^c\) and hence
\(\bigcap_{k = 1}^\infty A_k\) is also in \(\mathcal{A}\). \qed

\begin{definition}[Measurable Space]
  A set \(X\) equipped with a \(\sigma\)-algebra \(\mathcal{A}\) is called a 
  measurable space and is written as a tuple \((X, \mathcal{A})\). Furthermore, 
  if \(A \subseteq X\) is in \(\mathcal{A}\), then we say \(A\) is a measurable 
  set.
\end{definition}

\begin{definition}[Measure]
  Let \((X, \mathcal{A})\) is a measurable space. Then a measure on \((X, \mathcal{A})\) 
  is a function \(\mu : \mathcal{A} \to [0, \infty]\) such that 
  \begin{itemize}
    \item \(\mu(\varnothing) = 0\);
    \item if \((A_k)_{k = 1}^\infty \subseteq \mathcal{A}\) is a sequence of 
      pairwise disjoint sets, then 
      \[\mu\left(\bigcup_{k = 1}^\infty A_k\right) = \sum_{k = 1}^\infty \mu(A_k)\].
  \end{itemize}
  We call the second property \(\sigma\)-additivity. 
\end{definition}

\begin{definition}[Measure Space]
  A measurable space \((X, \mathcal{A})\) equipped with the measure \(\mu\) is 
  called a measure space and is written as a triplet \((X, \mathcal{A}, \mu)\).
\end{definition}

A commonly used measure on any arbitrary measurable space
\((X, \mathcal{A})\) is the counting measure \(\mu\). As the name
suggests, for all \(A \in \mathcal{A}\), \(\mu(A) = |A|\) if \(A\) is
finite and \(\infty\) otherwise. Another example of a measure is the
Dirac measure \(\delta_x : \mathcal{A} \to [0, \infty]\) for some
\(x \in X\) where for all \(A \in \mathcal{A}\), \(\delta_x(A) = 1\) if
\(x \in A\) and 0 otherwise. For the last example, let \(X\) be
uncountable and let
\(\mathcal{A} := \{A \subseteq X \mid A \text{ or } A^c \text{ is uncountable}\}\).
Then, one can show that \(\{X, \mathcal{A}\}\) forms a measurable space
and we find that the function \(\mu : \mathcal{A} \to [0, \infty]\)
defined as \(\mu(A) = 0\) if \(A\) is countable and \(\mu(A) = 1\) if
\(A^c\) is countable is a measure on \((X, \mathcal{A})\).

\begin{prop}
  Let \((X, \mathcal{A}, \mu)\) be a measure space. Then, 
  \begin{itemize}
    \item if \(A, B \in \mathcal{A}\) and \(A \subseteq B\), then \(\mu(A) \le \mu(B)\);
    \item if \(n \ge 1\), \((A_k)_{k = 1}^n\) is a sequence of pairwise disjoint sets 
      in \(\mathcal{A}\), then \[\mu\left(\bigcup_{k = 1}^n A_k\right) = 
        \sum_{k = 1}^n \mu (A_k);\]
    \item if \((A_k)_{k = 1}^\infty\) is a sequence of monotonically increasing 
      sets in \(\mathcal{A}\), then 
        \[\mu\left(\bigcup_{k = 1}^\infty A_k\right) = \lim_{k \to \infty}\mu(A_k).\]
  \end{itemize}
  We note that the limit in part 3 exists since the limit in monotonically increasing 
  on the extended reals (so bounded by \(\infty\)). 
  \begin{itemize}
    \item if \((A_k)_{k = 1}^\infty\) is a sequence of monotonically decreasing 
      sets in \(\mathcal{A}\), if \(\mu(A_1) < \infty\), then
      \[\mu\left(\bigcap_{k = 1}^\infty A_k\right) = \lim_{k \to \infty}\mu(A_k).\]
    \item if \(A \in \mathcal{A}\) and \((A_k)_{k = 1}^\infty\) is a sequence in 
      \(\mathcal{A}\), then \(\mu(A) \le \sum_{k = 1}^\infty \mu(A_k)\).
  \end{itemize}
  The last property is refereed to as \(\sigma\)-sub-additivity.
\end{prop}
\proof

Part 2 is trivial.

(Part 1) As \(B = A \sqcup B \setminus A = A \sqcup (A^c \cap B)\) where
\(A^c \cap B\) is measurable since both \(A^c\) and \(B\) are. So, by
\(\sigma\)-additivity,
\[\mu(B) = \mu(A \sqcup (A^c \cap B)) = \mu(A) + \mu(A^c \cap B) \ge \mu(A).\]
(Part 3) Define \(B_1 = A_1\) and
\(B_{k + 1} = A_{k + 1} \setminus A_k\). Then, \((B_k)_{k = 1}^\infty\)
is a sequence of disjoint subset in \(\mathcal{A}\). So, by
\(\sigma\)-additivity, \[\mu\left(\bigcup_{k = 1}^\infty A_k\right) = 
    \mu\left(\bigcup_{k = 1}^\infty B_k\right) = 
    \sum_{k = 1}^\infty \mu(B_k) = \lim_{n \to \infty} \sum_{k = 1}^n \mu(B_k)
    = \lim_{n \to \infty} \mu\left(\bigcup_{k = 1}^n B_k\right)= \lim_{n \to \infty} \mu(A_k). \]
(Part 4) Define \(B_k = A_1 \setminus A_k\), then
\((B_k)_{k = 1}^\infty\) is a sequence of monotonically increasing sets
in \(\mathcal{A}\). So, by part 3,
\[\mu\left(\bigcup_{k = 1}^\infty B_k \right) = \lim_{k \to \infty} \mu(B_l).\]
Furthermore, as \(A \subseteq B\) implies
\(\mu (B) - \mu(A) = \mu(B \setminus A)\), we have
\[\mu(A_1) - \mu \left(\bigcap_{k = 1}^\infty A_k\right) = 
    \mu\left(A_1 \setminus \bigcap_{k = 1}^\infty A_k\right) = 
    \mu\left(\bigcup_{k = 1}^\infty B_k \right) = \lim_{k \to \infty} \mu(B_k)
    = \mu(A_1) - \lim_{k \to \infty} \mu(A_k),\] hence the result.

(Part 5) Exercise. \qed

\hypertarget{hahn-carathuxe9odory-extension-theorem}{%
\subsection{Hahn-Carathéodory Extension
Theorem}\label{hahn-carathuxe9odory-extension-theorem}}

While it is fun to work with abstract measures in general, it is also
useful to consider specific measures. In this section we will look at
how to construct measures on arbitrary spaces. The general idea for
constructing measures is that, given a \emph{premeasure}
\(\tilde{\mu}\), we may extend it to an \emph{outer measure} \(\mu^*\),
and finally with the outer measure, we may restrict it to a measure
\(\mu\).

\begin{definition}[Premeasure]
  Let \(\mathcal{A}\) be an algebra on \(X\). A function \(\mu : \mathcal{A} \to [0, \infty]\) 
  is a premeasure if it satisfies \(\mu(\varnothing) = 0\) and countable additivity; 
  that is, given \((A_n)_{n = 1}^\infty \subseteq \mathcal{A}\) that is pairwise disjoint, 
  \[\mu\left(\bigcup_{n = 1}^\infty A_n\right) = \sum_{n = 1}^\infty \mu(A_n),\]
  provided \(\bigcup_{n = 1}^\infty A_n \in \mathcal{A}\).
\end{definition}
\begin{definition}[Outer Measure]
  A function \(\mu : \mathcal{P}(X) \to [0, \infty]\) is an outer measure if it 
  satisfies \(\mu(\varnothing) = 0\) and sub-additivity, that is, 
  if \((A_k)_{k = 1}^\infty\) is a sequence of subsets of \(X\), and 
  \(A \subseteq \bigcup A_k\) then 
  \[\mu(A) \le \sum_{k = 1}^\infty \mu(A_k).\]
\end{definition}

\begin{lemma}[Monoticity of Outer Measures]
  Let \(\mu : \mathcal{P}(X) \to [0, \infty]\) be an outer measure on \(X\). Then 
  for all \(A \subseteq B \subseteq X\), 
  \[\mu(A) \le \mu(B).\]
\end{lemma}
\proof

By defining the sequence \(A_1 = B\) and \(A_n = \varnothing\) for all
\(n > 1\), by the sub-additivity property of outer measure, we have
\(A \subseteq B = \bigcup A_n\), and so
\[\mu(A) \le \sum\mu(A_n) = \mu(B) + \mu(\varnothing) + \cdots = \mu(B).\]
\qed

In order to prove the aforementioned argument, we will require some
proposition. However, as will be demonstrated below, the notion of
premeasure is in fact, too strict. Thus, for that reason, let us
introduce the following definition.

\begin{definition}[Cover]
  A family of sets \(\mathcal{K} \subseteq \mathcal{P}(X)\) is called a cover 
  of \(X\) if \(\varnothing \in \mathcal{K}\) and there exists a sequence 
  \((K_n)_{n = 1}^\infty\) in \(\mathcal{K}\) such that 
  \[X \subseteq \bigcup_{n = 1}^\infty K_n.\]
\end{definition}
\begin{remark}
  We note that this is a different definition of covers than that we had learnt 
  for the definition compactness of topological spaces.
\end{remark}

Straight away, we see that every algebra \(\mathcal{A}\) of \(X\) is a
cover of \(X\) as \(X \in \mathcal{A}\) and so we can simply let the the
countable sequence be \(K_n = X\). Thus, every proposition we prove
about covers apply also to algebras.

\begin{prop}\label{cath_mea}
  Let \(\mathcal{K}\) be a cover of \(X\), and \(\tilde{\mu} : \mathcal{K} \to [0, \infty]\) 
  be a map such that \(\tilde{\mu}(\varnothing) = 0\). Then  
  \[\mu^* : \mathcal{P}(X) \to [0, \infty] := A \mapsto 
    \inf \left\{\sum_{j = 1}^\infty \tilde{\mu}(K_j) \mid (K_j)_{j = 1}^\infty 
    \subseteq \mathcal{K} \wedge A \subseteq \bigcup_{j = 1}^\infty K_j \right\}\]
  is an outer measure on \(X\).
\end{prop}
\proof

\(\mu^*\) is well defined since for all \(A \subseteq X\), by the
definition of covers, there exists some \((K_n)_{n = 1}^\infty\),
\(\bigcup K_n \supseteq X \supseteq A\), and so, we are taking the
infimum of a non-empty set. Clearly \(\mu^*(\varnothing) = 0\) since we
can choose \(K_n = \varnothing\) and so, it remains to show
sub-additivity.

Let \((A_n)_{n = 1}^\infty\) be a sequence of subsets of \(X\), and
suppose \(A \subseteq \bigcup A_n\). For each \(n \in \mathbb{N}\) and
\(\epsilon > 0\), by the definition of infimum, there exists some
\((K_{n, j})_{j = 1}^\infty \subseteq \mathcal{K}\) such that
\(A_n \subseteq \bigcup K_{n, j}\) and
\[\sum_{j = 1}^\infty \tilde{\mu}(K_{n, j}) < \mu^*(A_n) + 2^{-n} \epsilon.\]
Now, by the fact that \(A \subseteq \bigcup A_n\), we have
\(A \subseteq \bigcup_n \bigcup_j K_{n, j}\), and so, again by the
definition of \(\mu^*\), we have
\[\mu^*(A) \le \sum_{n = 1}^\infty \sum_{j = 1}^\infty\tilde{\mu}(K_{n, j})
    < \sum_{n = 1}^\infty (\mu^*(A_n) + 2^{-n}\epsilon) 
    = \sum_{n = 1}^\infty \mu^*(A_n) + \epsilon.\] As \(\epsilon > 0\)
was arbitrary, \[\mu^*(A) \le \sum_{n = 1}^\infty \mu^*(A_n),\] so
\(\mu^*\) is a outer measure. \qed

With that, we can naturally construct a outer measure from a premeasure
(and in fact, weaker notions suffices). This, outer measure however, in
some sense overshoots measures as it is defined on all subsets of \(X\),
and does not attain \(\sigma\)-additivity but only
\(\sigma\)-sub-additivity.

\begin{lemma}\label{cath_sig}
  Let \(\mu^*\) be an outer measure on \(X\), then 
  \[\Sigma := \{A \subseteq X \mid \mu^*(B) = \mu^*(B \cap A) + \mu^*(B \cap A^c)\}\]
  is a \(\sigma\)-algebra on \(X\).
\end{lemma}
\begin{remark}
  By sub-additivity, we see that \(\Sigma\) is equivalently defined by requiring 
  \(\mu^*(B) \ge \mu^*(B \cap A) + \mu^*(B \cap A^c)\).
\end{remark}
\proof

\(\varnothing \in \Sigma\) since for all \(B \subseteq X\),
\(B \cap \varnothing = \varnothing\) and \(B \cap \varnothing^c = B\)
and so \[\mu^*(B \cap \varnothing) + \mu^*(B \cap \varnothing^c) 
    = \mu^*(\varnothing) + \mu^*(B) = \mu^*(B).\] Let \(A \in \Sigma\),
then for all \(B \subseteq X\),
\[\mu^*(B) = \mu^*(B \cap A) + \mu^*(B \cap A^c) 
    = \mu^*(B \cap (A^c)^c) + \mu^*(B \cap A^c),\] and so,
\(A^c \in \Sigma\).

To show that \(\Sigma\) is closed under union, let us first show that
\(\Sigma\) is closed under finite intersections. Let
\(A_1, A_2 \in \Sigma\), then for all \(B \subseteq X\), \[\begin{split}
    \mu^*(B) & = \mu^*(B \cap A_1) + \mu^*(B \cap A_1^c)\\
      & = \mu^*(B \cap A_1 \cap A_2) + \mu^*(B \cap A_1 \cap A_2^c) + \mu^*(B \cap A_1^c)\\
      & = \mu^*(B \cap (A_1 \cap A_2)) + \mu^*(B \cap (A_1 \cap A_2)^c \cap A_1)
         + \mu^*(B \cap (A_1 \cap A_2)^c \cap A_1^c)\\
      & = \mu^*(B \cap (A_1 \cap A_2)) + \mu^*(B \cap (A_1 \cap A_2)^c),
  \end{split}\] and so \(A_1 \cap A_2 \in \Sigma\). Now, suppose
\((A_n)\) is a sequence of disjoint sets in \(\Sigma\), it suffices to
show \(\bigcup_{n = 1}^\infty A_n \in \Sigma\) (we can assume this since
given a sequence of sets, we may define another disjoint sequence such
that their union are equal). Since the sequence is pairwise disjoint, we
have \[\begin{split}
    \mu^*(B) & = \mu^*(B \cap A_1) + \mu^*(B \cap A_1^c)\\
      & = \mu^*(B \cap A_1) + \mu^*(B \cap A_1^c \cap A_2) + \mu^*(B \cap A_1^c \cap A_2^c).
  \end{split}\] Indeed, as \(A_1 \cap A_2 = \varnothing\),
\(A_1^c \cap A_2 = A_2\) and so, \[\begin{split}
    \mu^*(B) & = \mu^*(B \cap A_1) + \mu^*(B \cap A_2) + \mu^*(B \cap A_1^c \cap A_2^c)\\
      & = \cdots\\
      & = \sum_{j = 1}^n \mu^*(B \cap A_j) + \mu^*\left(B \cap \bigcap_{j = 1}^n A_j^c\right)\\
      & = \sum_{j = 1}^n \mu^*(B \cap A_j) + \mu^*\left(B \cap \overline{\bigcup_{j = 1}^n A_j}\right)
  \end{split}\] for all \(n \in \mathbb{N}\). By sub-additivity, we have
\[\mu^*\left(B \cap \bigcup_{j = 1}^n A_j\right) \le \sum_{j = 1}^n \mu^*(B \cap A_j),\]
and so, by taking \(n \to \infty\), we have
\[\mu^*(B) \ge \mu^*\left(B \cap \bigcup_{j = 1}^\infty A_j\right) + 
    \mu^*\left(B \cap \overline{\bigcup_{j = 1}^\infty A_j}\right),\]
implying \(\bigcup A_n \in \Sigma\). \qed

\begin{theorem}[Hahn-Carathéodory Extension Theorem]
  Let \(X\) be an arbitrary set, \(\mathcal{A}\) an algebra over \(X\) and 
  \(\tilde{\mu} : \mathcal{A} \to [0, \infty]\) a premeasure on \(X\). Then by 
  defining \(\mu^*\) as in proposition \ref{cath_mea}, \(\Sigma\) as in
  lemma \ref{cath_sig}, and by defining \(\mu = \mu^* \mid_\Sigma\), then,
  \begin{itemize}
    \item \((X, \Sigma, \mu)\) is a measure space;
    \item \(\mathcal{A} \subseteq \Sigma\);
    \item for all \(A \in \mathcal{A}\), \(\mu(A) := \mu^*(A) = \tilde{\mu}(A)\).
  \end{itemize}
\end{theorem}
\proof

By construction, we have \(\mu^*\) is an outer measure on \(X\) and
\(\Sigma\) is a \(\sigma\)-algebra on \(X\), and so, for the first part
of the proof, it remains to show that \(\mu = \mu^*\mid_\Sigma\) is a
measure on the measurable space \((X, \Sigma)\).

Indeed, \(\mu(\varnothing) = 0\) as \(\mu^*(\varnothing) = 0\) since it
is an outer measure, so let us consider \(\sigma\)-additivity. Let
\(A, B \in \Sigma\), \(A \cap B = \varnothing\), then \[\begin{split}
    \mu(A \cup B) & = \mu^*(A \cup B) = \mu^*((A \cup B) \cap A) + \mu^*((A \cup B) \cap A^C) \\
      & = \mu^*(A) + \mu^*(B),
  \end{split}\] and so, by induction \(\mu\) is finitely additive. So,
if \((A_n)_{n = 1}^\infty\) is a sequence of pairwise disjoint
measurable sets, then, for all \(m \in \mathbb{N}\),
\[\sum_{n = 1}^m \mu(A_n) = \mu\left(\bigcup_{n = 1}^m A_n\right) 
    \le \mu\left(\bigcup_{n = 1}^\infty A_n\right),\] where the
inequality is due to the monotonicity of outer measures. So, by taking
\(m \to \infty\) we have
\[\sum_{n = 1}^\infty \mu(A_n) \le \mu\left(\bigcup_{n = 1}^\infty A_n\right).\]
However, by the sub-additivity of outer measures,
\[\sum_{n = 1}^\infty \mu(A_n) \ge \mu\left(\bigcup_{n = 1}^\infty A_n\right),\]
and so \(\sum \mu(A_n) \ge \mu\left(\bigcup A_n\right)\) resulting in
\(\mu\) being a measure.

For the second part of the theorem, it suffices to show that for all
\(A \in \mathcal{A}\), for all \(B \subseteq X\),
\[\mu^*(B) \ge \mu^*(B \cap A) + \mu^*(B \cap A^c).\] By recalling the
definition of \(\mu^*\), for all \(\epsilon > 0\), there exists some
sequence \((K_j)_{j = 1}^\infty \subseteq \mathcal{A}\),
\(B \subseteq \bigcup K_j\),
\[\sum_{j = 1}^\infty \tilde{\mu}(K_j) \le \mu^*(B) + \epsilon.\] Now,
as \(B \subseteq \bigcup K_j\),
\(B \cap A \subseteq \bigcup (K_j \cap A)\) and
\(B \cap A^c \subseteq \bigcup (K_j \cap A^c)\), and so, by
sub-additivity \[\begin{split}
    \mu^*(B \cap A) + \mu^*(B \cap A^c) 
      & \le \sum \mu^*(K_j \cap A) + \sum \mu^* (K_j \cap A^c)\\
      & = \sum (\tilde{\mu} (K_j \cap A) + \tilde{\mu} (K_j \cap A^c))\\
      & = \sum \tilde{\mu}(K_j) \le \mu^*(B) + \epsilon,
  \end{split}\] where we used the last part of the theorem to exchange
\(\mu^*\) for \(\tilde{\mu}\). Thus, as \(\epsilon > 0\) was arbitrary,
the inequality follows.

Lastly, to show that \(\mu^*\) agrees with \(\tilde{\mu}\) on
\(\mathcal{A}\), let \(A \in \mathcal{A}\). By the monotonicity of outer
measures, we have \(\mu^*(A) \ge \tilde{\mu}(A)\) and so, it suffices to
show there exists some \((K_j) \subseteq \mathcal{A}\) such that
\(A \subseteq \bigcup K_j\) and
\(\sum \tilde{\mu}(K_j) = \tilde{\mu}(A)\). But, this is trivial by
simply choosing \(A_1 = A\) and \(A_n = \varnothing\) for all \(n > 1\)
and so, we are done! \qed

With the Hahn-Carathéodory extension theorem, we can obtain a measure
(and also a measurable space), just from a premeasure on some algebra.
This is a very useful theorem as algebras and premeasures are rather
weak notions and can be easily constructed through many means. However,
this theorem does not yet guarantee the uniqueness, so one might ask
whether or not there are other extensions. We shall take a look at that
now.

\begin{definition}[\(\sigma\)-Finite]
  A premeasure \(\tilde{\mu}\) on the algebra \(\mathcal{A}\) on \(X\) is \(\sigma\)-finite 
  if there exists disjoint sets \((S_n)_{n = 1}^\infty \subseteq \mathcal{A}\) such 
  that \(X = \bigcup_{n = 1}^\infty S_n\) and \(\tilde{\mu}(S_n) < \infty\) for all 
  \(n \ge 1\). 
\end{definition}

\begin{theorem}[Uniqueness of the Hahn-Carathéodory Extension]
  Under the assumption of the Hahn-Carathéodory extension theorem, and if 
  \(\tilde{\mu}\) is \(\sigma\)-finite. Then, for all outer measures 
  \(\nu : \mathcal{P}(X) \to [0, \infty]\), 
  \[\nu\mid_\Sigma = \mu,\]
  where \(\mu\) is the outer measure obtained from the Hahn-Carathéodory extension.
\end{theorem}
\proof

Let \(A \in \Sigma\), and we will first show \(\nu(A) \le \mu(A)\). Let
\((A_n)_{n = 1}^\infty \subseteq \mathcal{A}\) be some sequence such
that \(A \subseteq \bigcup A_n\). Then, by the sub-additivity of
\(\nu\), \[\nu(A) \le \sum \nu(A_n) = \sum \tilde{\mu}(A_n).\] So, by
taking the infimum over all possible \((A_n)\), the inequality is
achieved.

To show the reverse inequality, let us suppose \((*)\) that there exists
some \(S \in \mathcal{A}\) such that \(A \subseteq S\) and
\(\mu(S) < \infty\). Then,
\[\nu(A) + \nu(S \cap A^c) \le \mu(A) + \mu(S \cap A^c) = \mu(S) = \tilde{\mu}(S) = \nu(S).\]
Now, by sub-additivity, \[\nu(S) \le \nu(A) + \nu(S \cap A^c),\] and so,
\(\nu(A) + \nu(S \cap A^c) \ge \mu(A) + \mu(S \cap A^c)\),
hence\footnote{
    Wlog. \(\mu(A) < \infty\) since if otherwise, \(\infty < \nu(A) + \nu(S \cap A^c)\). 
    Since \(\nu(S \cap A^c) \le \nu(S) \le \mu(S) < \infty\), \(\nu(A) = \infty\) 
    and hence \(\nu(A) \ge \mu(A)\).},
\[\nu(A) - \mu(A) \ge \mu(S \cap A^c) - \nu(S \cap A^c) \ge 0,\] as
\(\mu \ge \nu\) as shown previously. Thus, \(\nu(A) \ge \mu(A)\) and so,
\(\nu\mid_\Sigma = \mu\).

Now, to relax the assumption that such \(S\) exists, we shall use the
\(\sigma\)-finiteness of \(\tilde{\mu}\). Let
\((S_n) \subseteq \mathcal{A}\) be the sequence as described by the
\(\sigma\)-finiteness of \(\tilde{\mu}\), and define
\(A_n = A \cap S_n\). Then, by construction, the sets \(A_n\) are
pairwise disjoint and \(A = \bigcup A_n\). Since \(\mu = \nu\) on sets,
which \((*)\) is satisfied, we have
\[\mu\left(\bigcup_{n = 1}^m A_n\right) = \nu\left(\bigcup_{n = 1}^m A_n\right),\]
for all \(m \ge 1\) (since we can choose \(S = \bigcup_{n = 1}^m S_n\)).
Now, by monotonicity,
\[\nu(A) = \nu\left(\bigcup_{n = 1}^\infty A_n\right) \ge \nu\left(\bigcup_{n = 1}^m A_n\right)
    = \mu\left(\bigcup_{n = 1}^m A_n\right),\] for all \(m\), the
inequality is achieved by taking \(m \to \infty\). \qed

\hypertarget{the-lebesgue-measure}{%
\subsection{The Lebesgue Measure}\label{the-lebesgue-measure}}

With the Hahn-Carathéodory extension theorem in mind, we may construct
the Lebesgue measure on Euclidean spaces. As with the proof of the
extension theorem, we shall construct a premeasure assigning \(b - a\)
to every interval \((a, b)\) and then, extend that to a general measure.

\begin{definition}
  For \(a = (a_1, \cdots, a_n) \in \mathbb{R}^n\), \(b = (b_1, \cdots, b_n) \in \mathbb{R}^n\),
  we define the interval between \(a\) and \(b\) to be the set 
  \[(a, b) := \prod_{k = 1}^n(a_k, b_k) = 
    \{(x_1, \cdots, x_n) \mid a_k < x_k < b_k \hspace{2mm} 1 \le k \le n \},\]
  if \(a_k < b_k\) for all \(k\) and \((a, b) = \varnothing\) otherwise.
\end{definition}

Similarly, we define the half open and closed intervals in
\(\mathbb{R}^n\) with \((a, b] := \prod_{k = 1}^n(a_k, b_k]\),
\([a, b) := \prod_{k = 1}^n[a_k, b_k)\) and
\([a, b] := \prod_{k = 1}^n[a_k, b_k]\). Indeed, we also allow
\(\pm \infty\) as an endpoint and we shall from this point forward refer
to such sets as intervals in \(\mathbb{R}^n\).

\begin{definition}[Elementary Figure]
  A set \(I \subseteq \mathbb{R}^n\) is an elementary figure if its the union 
  of finitely many disjoint intervals; and in this section, we shall denote 
  \(\mathcal{A} \subseteq \mathcal{P(}\mathbb{R}^n)\) for the set of elementary 
  figures in \(\mathbb{R}^n\).
\end{definition}

We see that \(\mathcal{A}\) is an algebra on \(X = \mathbb{R}^n\) and
so, we may define a premeasure on \(\mathcal{A}\). Let
\(\tilde{\lambda} : \mathcal{A} \to [0, \infty]\) be the function such
that for all \(a, b \in \mathbb{R}^n\),
\[\tilde{\lambda}((a, b)) = \tilde{\lambda}((a, b]) = 
  \tilde{\lambda}([a, b)) = \tilde{\lambda}([a, b]) := \prod_{k = 1}^n(b_k - a_k),\]
if \(a_k < b_k\) and 0 otherwise. Furthermore, for
\(\bigcup_{k = 1}^m I_k \in \mathcal{A}\),
\[\tilde{\lambda}\left(\bigcup_{k = 1}^m I_k \right) = \sum_{k = 1}^m \tilde{\lambda}(I_k),\]
where \(I_1, \cdots, I_k\) are disjoint intervals.

\begin{lemma}
  The map \(\tilde{\lambda}\) is a premeasure on \(\mathcal{A}\).
\end{lemma}
\proof

As it is trivially true that \(\tilde{\lambda}(\varnothing) = 0\) to
show that \(\tilde{\lambda}\) is a premeasure, it suffices to show
\(\sigma\)-additivity within \(\mathcal{A}\).

We note that \(\tilde{\lambda}\) is finitely additive by definition,
hence monotone on \(\mathcal{A}\), and therefore if
\(I = \bigcup_{k = 1}^\infty\) where \(I_k\) are disjoint intervals,
\[\tilde{\lambda}(I) \ge \tilde{\lambda}\left(\bigcup_{k = 1}^m I_k\right) = 
    \sum_{k = 1}^m\tilde{\lambda}(I_k),\] for all \(m \in \mathbb{N}\).
Thus, by taking \(m \to \infty\),
\[\tilde{\lambda}(I) \ge \sum_{k = 1}^\infty \tilde{\lambda}(I_k).\] For
the reverse inequality, we use the what is called a \emph{compactness
argument} to reduce to finite additivity. Wlog. we may assume
\(\sum \tilde{\lambda}(I_k) < \infty\) (since if otherwise the reverse
inequality is trivial) and that \(I\) is a single interval with end
points \(a, b\) (since if the inequality is true for a single interval,
it is also true for the sum of finitely many intervals).

Let \(\bar{I}\) be the closure of \(I\) and for all \(L > 0\) we define
\(\bar{I}_L := \bar{I} \cap [-L, L]^n\). By Heine-Borel, \(\bar{I}_L\)
is compact and moreover, by taking \(L \to \infty\),
\[\tilde\lambda(\bar{I}_L) \to \tilde\lambda(\bar{I}) = \tilde\lambda(I).\]
Now, for all intervals \(J\) with end points \(\alpha, \beta\), we
define the interval \(J^\epsilon \supseteq J\) with endpoints
\(\alpha^\epsilon \neq \alpha\), \(\beta^\epsilon \neq \beta\) such that
\[\tilde\lambda(J^\epsilon) \le (1 + \epsilon)^n \tilde\lambda(J).\]
Lastly, for all \(k \in \mathbb{N}\), we define the open intervals
\(\tilde I_k\) with \(\tilde I_k \supseteq I_k^\epsilon\) satisfying
\[\tilde\lambda(\tilde I_k) < (1 + \epsilon)^n \lambda(I_k) + \epsilon 2^{-k}.\]
So
\(\bar{I}_L \subseteq \bar{I} \subseteq \bigcup_{k = 1}^\infty I_k^\epsilon  \subseteq \bigcup_{k = 1}^\infty \tilde I_k\),
and \(\{\tilde I_k\}\) forms an open cover of \(\bar{I}_L\), and hence,
by compactness, there exists a finite subcover for \(\bar{I}_L\), that
is, there exists some \(m\) such that (by reordering),
\(\bar{I}_L \subseteq \bigcup_{k = 1}^m I_k\). It follows that
\[\tilde\lambda(\bar{I}_L) \le \tilde\lambda\left(\bigcup_{k = 1}^m \tilde I_k\right) 
    \le \sum_{k = 1}^m \tilde\lambda(\tilde I_k) 
    \le (1 + \epsilon)^n \sum_{k = 1}^\infty \lambda(I_k) + \epsilon.\]
Thus, by taking \(\epsilon \to 0\) and then \(L \to \infty\) we have the
reverse inequality and so \(\tilde\lambda\) is a premeasure on
\(\mathcal{A}\). \qed

With this lemma, one can immediately apply the Hahn-Carathéodory
extension theorem resulting in the Lebesgue measure on Euclidean spaces,
and furthermore, by considering
\(\tilde\lambda((z, z + 1]) = 1 < \infty\), and
\(\bigcup_{z \in \mathbb{Z}^n}(z, z + 1] = \mathbb{R}^n\), we have
\(\tilde\lambda\) is \(\sigma\)-finite, and hence, the Lebesgue measure
is unique.

\begin{lemma}
  Let \(\mathcal{B}(\mathbb{R}^n)\) be the Borel \(\sigma\)-algebra on \(\mathbb{R}^n\), 
  then \(\mathcal{B}(\mathbb{R}^n) \subseteq \Sigma\) where \(\Sigma\) is the 
  \(\sigma\)-algebra induced by the Lebesgue measure.
\end{lemma}
\proof

Since \(\mathcal{B}(\mathbb{R}^n)\) is the \(\sigma\)-algebra generated
by the set of open sets of \(\mathbb{R}^n\), it suffices to show that
for all open sets \(O \subseteq \mathbb{R}^n\),
\(O \in \sigma(\mathcal{A}) \subseteq \Sigma\).

For all \(m \in \mathbb{N}\), define
\[C_m := \{[z, z + 2^{-m}) \mid z \in 2^{-m}\mathbb{Z}^n\} \subseteq \mathcal{A},\]
that is the grid of half open cubes covering \(\mathbb{R}^n\) with
individual cubes having length \(2^{-m}\). Then, by letting
\(C_m' := \{U \in C_m \mid U \subseteq O\}\), we have
\(C = \bigcup_{m \in \mathbb{N}} C_m'\) which is a countable set of half
open cubes. Now, we see that \(C = O\) since \(C \subseteq O\) trivially
and for all \(o \in O\), as \(O\) is open, there exists some
\(\epsilon > 0\) such that \(B_\epsilon(o) \subseteq O\) and so, \(o\)
is contained in one of the cubes with length \(< 2^{-m}\) where
\(m > 2 / \epsilon\) and so
\(O \in \sigma(\mathcal{A}) \subseteq \Sigma\). \qed

With that, we see that all Borel sets in \(\mathbb{R}^n\) are Lebesgue
measurable and restricting \(\tilde\lambda\) onto
\(\mathcal{B}(\mathbb{R}^n)\), we have the following measure space on
\(\mathbb{R}^n\).

\begin{definition}
  The Lebesgue measure \(\lambda : \mathcal{B}(\mathbb{R}^n) \to [0, \infty]\) is 
  the Hahn-Carathéodory extension of \(\tilde\lambda\) restricted onto 
  \(\mathcal{B}(\mathbb{R}^n)\).
\end{definition}

We note that, if \((X, \mathcal{F}, \mu)\) is a measure space and
\(A \in \mathcal{F}\), then by defining
\(\mathcal{F}\mid_A := \{A \cap B \mid B \in \mathcal{F}\}\) and
\(\mu\mid_A(B) := \mu(B)\) for all \(B \in \mathcal{F}\),
\(B \subseteq A\), it is easy to see that \(\mathcal{F}\mid_A\) is a
\(\sigma\)-algebra on \(A\) and \(\mu\mid_A\) is a measure on
\((A, \mathcal{F}\mid_A)\) and is called the restriction of \(\mu\) to
\(A\). Indeed, with this in mind, we see that the Lebesgue measure can
be restricted on small sets such as intervals; in particular, by
restricting the Lebesgue measure on \([0, 1]\), the resulting measure
\(\lambda\mid_{[0, 1]}\) is a probability measure.

\hypertarget{lebesgue-measurable-sets}{%
\subsection{Lebesgue Measurable Sets}\label{lebesgue-measurable-sets}}

We investigate which real sets are Lebesgue measurable.

\begin{prop}
  For all \(A \in \mathcal{B}(\mathbb{R}^n)\), 
  \[\lambda(A) = \inf_{G \supseteq A; G \text{open}} \lambda(G).\]
\end{prop}
\proof

Since measures are monotone, \((\le)\) is established. By recalling the
construction of the Lebesgue measure, and by the properties of \(\inf\),
for all \(\epsilon > 0\), there exists some
\((K_n)_{n = 1}^\infty \subseteq \mathcal{A}\), such that
\(A \subseteq \bigcup K_n\) and
\[\lambda(A) + \epsilon = \lambda^*(A) + \epsilon \ge 
    \sum_{n = 1}^\infty \tilde\lambda (K_n) \ge 
    \tilde\lambda\left(\bigcup K_n\right) = \lambda\left(\bigcup K_n\right)
    \ge \inf_{G \supseteq A; G \text{open}} \lambda(G).\] since the
union of open sets is open, \(\bigcup K_n\) is open and contains \(A\).
So, as \(\epsilon > 0\) was arbitrary, \((\ge)\) is established. \qed

By inspection of the proof, we find the statement to be true for any
real sets provided with change \(\lambda\) to the outer measure
\(\lambda^*\) on the left hand side. This \emph{regularity} of
measurable sets is expressed in the following.

\begin{prop}\label{exist_open_near}
  If \(A \in \mathcal{B}(\mathbb{R}^n)\), then for all \(\epsilon > 0\), there 
  exists some \(G \supseteq A\), \(G\) open such that \(\lambda(G \setminus A) < \epsilon\).
\end{prop}
\proof

One can of course prove it using the construction of the Lebesgue
measure, however, a stronger proposition holds. \qed

\begin{prop}
  Let \(\mathcal{A}\) be an algebra and \(\mu\) an measure on \(\sigma(\mathcal{A})\) 
  which is \(\sigma\)-finite on \(\mathcal{A}\). Then, for all \(A \in \sigma(\mathcal{A})\), 
  and \(\epsilon > 0\), there exist disjoint sets \((A_n)_{n = 1}^\infty \in \mathcal{A}\) 
  such that \(A \subseteq \bigcup A_n\) and 
  \(\mu\left(\bigcup A_n \setminus A\right) < \epsilon\).
\end{prop}
\proof

Since \(\mu\) is \(\sigma\)-finite on \(\mathcal{A}\), there exists a
sequence of sets \((S_n) \subseteq \mathcal{A}\) such that
\(X \subseteq \bigcup S_n\) and \(\mu(S_n) < \infty\) for all \(n\).

By restricting \(\mu\) on \(\mathcal{A}\), we have a pre-measure on
\(\mathcal{A}\) whose extended outer-measure \(\mu^*\) agrees with
\(\mu\) on \(\sigma(\mathcal{A})\) by the uniqueness of the
Hahn-Carathéodory extension. Thus,
\[\mu(A) = \mu^*(A) = \inf \left\{ \sum \mu\mid_\mathcal{A}(K_i) \mid (K_i) \subseteq \mathcal{A} 
  \wedge A \subseteq \bigcup K_j\right\}.\] Now, since \(\mu(A)\) is the
least lower bound of
\(B :=  \left\{ \sum \mu\mid_\mathcal{A}(K_i) \mid (K_i) \subseteq \mathcal{A}  \wedge A \subseteq \bigcup K_j\right\}\),
there exists some \((K_{n, m}) \subseteq A_i\) such that for all
\(n \in \mathbb{N}\),
\(A \cap S_n \subseteq \bigcup_{m = 1}^\infty K_{n, m}\) and,
\[\mu(A \cap S_n) \ge \sum_{m = 1}^\infty \mu(K_{n, m}) - 2^{-n}\epsilon.\]
Then, by defining
\(\bigcup_{k = 1}^\infty A_k = \bigcup_{n = 1}^\infty  \bigcup_{m = 1}^\infty K_{n ,m}\)
where \(A_k = K_{i, j}\) for some \((i, j) \in \mathbb{N}\), we have a
disjoint sequence of sets and, \[\begin{split}
    \mu\left(\bigcup_{n = 1}^\infty (A_n \setminus A)\right)
    & = \mu\left(\bigcup_{n = 1}^\infty 
      \bigcup_{m = 1}^\infty (K_{n, m} \setminus (A \cap S_n))\right)\\
    & \le \sum_{n = 1}^\infty \left(\sum_{m = 1}^\infty \mu(K_{n, m}) - \mu(A \cap S_n)\right) 
    \le \epsilon.
  \end{split}\] \qed

Furthermore, by applying proposition \ref{exist_open_near} to \(A^c\)
for some \(A \in \mathcal{B}(\mathbb{R}^n)\), there exists some
\(\tilde G\) open, containing \(A^c\) such that
\(\lambda(\tilde G \setminus A^c) < \epsilon\) for all \(\epsilon > 0\).
Then, by defining \(F := \tilde G^c\), we have \(F \subseteq A\) closed,
such that
\[\lambda(A \setminus F) = \lambda(A \cap F^c) = \lambda (A \cap \tilde G) 
  = \lambda(\tilde G \setminus A^c) < \epsilon.\] Thus,
\[\lambda(G \setminus F) = 
  (\lambda(G) - \lambda(A)) + (\lambda(A) - \lambda(F)) 
  = \lambda(G \setminus A) + \lambda(A \setminus F) < 2 \epsilon.\] So,
for all \(A \in \mathcal{B}(\mathbb{R}^n)\), there exists some open
\(G \supseteq A\) and some closed \(F \subseteq A\) such that
\(\lambda(G \setminus F) < \epsilon\) for all \(\epsilon > 0\).

\begin{prop}[Transitional Invariance of \(\lambda\)]
  Let \(\Phi_{x_0} : \mathbb{R}^n \to \mathbb{R}^n : x \mapsto x + x_0\) for 
  some \(x_0 \in \mathbb{R}^n\). Then, 
  \[\lambda(\Phi_{x_0}(A)) = \lambda(A),\]
  for all \(A \in \mathcal{B}(\mathbb{R}^n)\).
\end{prop}
\proof

Since, for all \(A \in \mathcal{B}(\mathbb{R}^n)\), there exists some
open \(G \supseteq A\) such that \(\lambda(G) - \lambda(A) < \epsilon\),
it suffices to show transitional invariance for open sets. Now, as shown
previously, any open sets in \(\mathbb{R}^n\) can be written as a
disjoint union of countable intervals, the result follows since Lebesgue
measures are transitional invariant on intervals by definition. \qed

\begin{prop}
  \(\mathcal{B}(\mathbb{R}) \neq \mathcal{P}(\mathbb{R})\).
\end{prop}
\proof

As we have seen last term, the Vitali set is a classical example of a
non-measurable real set.

Define the equivalence relation \(\sim\) such that, for all
\(x, y \in (0, 1]\), \(x \sim y \iff x - y \in \mathbb{Q}\). Then, with
axiom of choice, for each equivalence class
\([x] \in (0, 1] \setminus \sim\), we choose exactly one \(v \in [x]\)
and we define the Vitali set \(V\) to be the set of these choices.

Now, let \(A := \mathbb{Q} \cap (-1, 1]\) and then,
\[(0, 1] \subseteq \bigcup_{q \in A} (q + V) \subseteq [-1, 2],\] where
the first inclusion is true since, for all \(x \in (0, 1]\), \(x\)
belongs to an equivalence class \([x']\) where \(x' \in V\). Now, as
\(x \in [x']\) implies \(x - x' \in \mathbb{Q}\), we can simply choose
\(q = x - x'\) and so \(x = q + x' \in \bigcup q + V\).

Thus, if \(V\) is measurable, then
\(1 \le \lambda(\bigcup(q + V)) \le 3\). Now, by observing that for all
\(p, q \in \mathbb{Q}\), if \(p \neq q\) then
\(p + V \cap q + V = \varnothing\),
\[\lambda\left(\bigcup_{q \in A}(q + V)\right) = \sum_{q \in A} \lambda(q + V)
    = \sum_{q \in A} \lambda(V),\] since \(\lambda\) is transitional
invariant. However, as \(\lambda(V)\) is bounded above by 3,
\(\lambda(V) = 0\) \# as \(\lambda(V) \ge 1\).

So \(V \not\in \mathcal{B}(\mathbb{R})\) and hence
\(\mathcal{B}(\mathbb{R}) \neq \mathcal{P}(\mathbb{R})\). \qed

\newpage

\hypertarget{functions-and-integrals-on-measure-spaces}{%
\section{Functions and Integrals on Measure
Spaces}\label{functions-and-integrals-on-measure-spaces}}

\hypertarget{measurable-functions}{%
\subsection{Measurable Functions}\label{measurable-functions}}

\begin{definition}
  Let \((X, \mathcal{A})\) and \((Y, \mathcal{A}')\) be measurable spaces and 
  \(f : X \to Y\) be a function. Then \(f\) is \(\mathcal{A} - \mathcal{A}'\) 
  measurable if for all \(A \in \mathcal{A}'\), 
  \[f^{-1}(A) := \{x \in X \mid f(x) \in A\} \in \mathcal{A}.\]
  In the special case that \(Y = \mathbb{R}\) and \(\mathcal{A}' = \mathcal{B}(\mathbb{R})\) 
  we say \(f\) is Borel-measurable.
\end{definition}

In applications to probability theory, we recall that one work with the
measure space \((\Omega, \mathcal{A}, \mathcal{P})\), and in particular,
if \(X : \Omega \to \mathbb{R}\) is
\(\mathcal{A} - \mathcal{B}(\mathbb{R})\) measurable, then \(X\) is
refereed to as a real-valued random variable.

While we may check the measurability of a function directly from
definition, the following lemma provides us with a easier method.

\begin{lemma}\label{measurable_gen}
  Let \(X, Y\), \(\mathcal{E} \subseteq \mathcal{P}(Y)\) be sets and 
  \(\mathcal{A}\) a \(\sigma\)-algebra on \(X\). Then a function 
  \(f : X \to Y\) is \(\mathcal{A} - \sigma(\mathcal{E})\) measurable 
  if and only if for all \(A \in E\), \(f^{-1}(A) \in \mathcal{A}\).
\end{lemma}
\proof

The forward direction is trivial so let us consider the reverse.

Consider the set
\(\mathcal{Q} := \{ S \in \sigma(\mathcal{E}) \mid f^{-1}(S) \in \mathcal{A}\}\).
It suffices to show \(\mathcal{Q}\) is a \(\sigma\)-algebra since, since
if that is the case, as \(\mathcal{E} \subseteq \mathcal{Q}\), we have
\(\sigma(\mathcal{E}) \subseteq \mathcal{Q}\).

Straight away, we have \(\varnothing \in \mathcal{Q}\) since
\(f^{-1}(\varnothing) = \varnothing \in \mathcal{A}\). Furthermore, if
\(A \in \mathcal{Q}\), then \(f^{-1}(A) \in \mathcal{A}\) and so
\(f^{-1}(A^c) = f^{-1}(A)^c \in \mathcal{A}\); and hence,
\(A^c \in \mathcal{Q}\). Lastly, if
\((A_n)_{n = 1}^\infty \subseteq \mathcal{Q}\), then
\(f^{-1}\left(\bigcup A_n \right) = \bigcup f^{-1}(A_n) \in \mathcal{A}\),
and so, \(\bigcup A_n \in \mathcal{Q}\). Thus, \(\mathcal{Q}\) is a
\(\sigma\)-algebra. \qed

With this lemma in mind, on can check the measurability of a function by
simply insuring the measurable of the preimage of sets belonging to the
generating set. As an example, we may show a function \(f\) to be
Borel-measurable by simply showing that for all
\(U \subseteq \mathbb{R}\), if \(U\) is open then
\(f^{-1}(U) \in \mathcal{B}(\mathbb{R})\). Indeed, we may further relax
this constraint by recalling that
\(\mathcal{B}(\mathbb{R}) = \sigma(\{(-\infty, y] \mid y \in \mathbb{R}\})\),
and so, it suffices to ensure the measurability of \((-\infty, y]\) ofr
all \(y \in \mathbb{R}\).

\begin{definition}
  If \(f : X \to \overline{\mathbb{R}} = [-\infty, \infty]\) be a function where 
  \((X, \mathcal{A})\) is a measurable space. Then \(f\) is 
  measurable if \(f^{-1}(\mathcal{B}(\mathbb{R})) \subseteq \mathcal{A}\) and 
  \(f^{-1}(\{\infty\}), f^{-1}(\{- \infty\}) \in \mathcal{A}\).
\end{definition}

With this definition in mind, let us consider some functions that are
measurable.

\begin{prop}
  Any continuous function \(f : X \to Y\) where \((X, \mathcal{T}_X), (Y, \mathcal{T}_Y)\) 
  are topological spaces is \(\mathcal{B}(X) - \mathcal{B}(Y)\) measurable.
\end{prop}
\proof

Follows directly by the definition of continuity and lemma
\ref{measurable_gen}. \qed

\begin{corollary}
  Any continuous function \(f : \mathbb{R}^n \to \mathbb{R}^m\) is Borel-measurable.
\end{corollary}

\begin{prop}
  Let \((X, \mathcal{A})\) be a measurable space and \(A \subseteq X\). Then 
  the indicator function of \(A\), defined as 
  \[\mathbf{1}_A : X \to \mathbb{R} : x \mapsto 
  \begin{cases}
    1, \hspace{1mm} x \in A\\
    0, \hspace{1mm} x \in A^c
  \end{cases}\]
  is measurable if and only if \(A \in \mathcal{A}\).
\end{prop}
\proof

Indeed, if \(A \not\in \mathcal{A}\), then, while \(\{1\}\) is
Borel-measurable, \(f^{-1}(\{1\}) = A \not\in \mathcal{A}\), and so
\(\mathbf{1}_A\) is not measurable.

On the other hand, if \(A \in \mathcal{A}\), then, for all
\(S \subseteq \mathbb{R}\), either \(0 \in S\), \(1 \in S\), both are in
\(S\), or neither are in \(S\) resulting in \(f^{-1}(S) = A, A^c, X\) or
\(\varnothing\), all of which are members of \(\mathcal{A}\). So \(f\)
is measurable since
\(\mathcal{B}(\mathbb{R}) \subseteq \mathcal{P}(\mathbb{R})\). \qed

With this proposition, we have \(\mathbf{1}_\mathbb{Q}\) is measurable
since \(\mathbb{Q}\) is countable and so, is a countable union of
singletons and hence is measurable.

\begin{prop}
  Let \((X, \mathcal{A}_X), (Y, \mathcal{A}_Y), (Z, \mathcal{A}_Z)\) be measurable 
  spaces. Then, if \(f : X \to Y\) and \(g : Y \to Z\) are both measurable, 
  then \(g \circ f : X \to Z\) is also measurable.
\end{prop}
\proof

This follows directly since for all \(U \in \mathcal{A}_Z\),
\((g \circ f)^{-1}(U) = f^{-1}(g^{-1}(U))\), and as \(g^{-1}(U)\) is
measurable as \(g\) is, \(f^{-1}(g^{-1}(U)) \in \mathcal{A}_X\) and so
\(g \circ f : X \to Z\) is measurable. \qed

\begin{theorem}
  Let \((X, \mathcal{A})\) be a measurable space and \(f, g : X \to \mathbb{R}\) 
  are \(\mathcal{A} - \mathcal{B}(\mathbb{R})\) measurable functions. Then, 
  \[f + g, \hspace{1mm} fg, \hspace{1mm} |f|, \hspace{1mm} f \wedge g := \min\{f, g\}, 
    \hspace{1mm} f \vee g := \max\{f, g\}, \hspace{1mm} \frac{1}{f},\]
  are all measurable (where the last function is measurable provided \(f(x) \neq 0\) 
  for all \(x\)). Furthermore, if \((f_n) : \mathbb{N} \to X \to \mathbb{R}\) 
  is a sequence of measurable functions, then 
  \[\inf_{n \in \mathbb{N}} f_n, \hspace{1mm} \sup_{n \in \mathbb{N}} f_n, 
    \hspace{1mm} \liminf_{n \to \infty} f_n, \hspace{1mm} \limsup_{n \to \infty} f_n\]
  are also measurable. 
\end{theorem}

As we shall see later, the construction of the Lebesgue integral allows
us to integral measurable function. Thus, with this theorem, we see the
limit of integrable functions are also integrable. This contrasts with
the Darboux integral where this is not necessarily the case (see
motivation).

\proof

\((f + g)\). It is not hard to see that
\[(f + g)^{-1}(- \infty, a) = \bigcup_{r \in \mathbb{Q}_{\le a}} 
    \bigcup_{s \in \mathbb{Q}_{\le a - r}} f^{-1} (-\infty, r) \cap g^{-1}(-\infty, s),\]
where the right hand side is measurable, and so \(f + g\) is measurable.

\((fg)\). We use the identity that
\(fg = \frac{1}{2}[(f + g)^2 - f^2 - g^2]\). Since
\(f^2 = (x \mapsto x^2 : \mathbb{R} \to \mathbb{R}) \circ f\) where
\(x \mapsto x^2 : \mathbb{R} \to \mathbb{R}\) is continuous and hence,
measurable, we have \(fg\) as a linear combination of measurable
functions, and so, by our previous result, \(fg\) is measurable.

\((|f|)\) \((f \wedge g)\) \((f \vee g)\). We define
\((\cdot)^+ : \mathbb{R} \to \mathbb{R} := s \mapsto \max\{s, 0\}\) and
\((\cdot)^- : \mathbb{R} \to \mathbb{R} := s \mapsto \max\{-s, 0\} = (-s)^+\).
Now, as both \((\cdot)^+\) and \((\cdot)^-\) are continuous, they are
measurable. So, since
\(|f| = ((\cdot)^+ \circ f) + ((\cdot)^- \circ f))\), we have \(|f|\) is
measurable. Similarly we see that \[f \wedge g = f - (g - f)^-,\] and
\[f \vee g = f + (g - f)^+,\] and so, both \((f \wedge g)\) and
\((f \vee g)\) are also measurable.

\((1 / f)\). Follows as \((1 / f)^{-1}(\infty, a)\) is
\(f^{-1}(1 / a, 0)\) for \(a < 0\), \(f^{-1}(- \infty, 0)\) for
\(a = 0\) and \(f^{-1}((-\infty, 0) \cup (1 / a, \infty))\) for
\(a > 0\).

\((\inf_{n \in \mathbb{N}} f_n)\) \((\sup_{n \in \mathbb{N}} f_n)\).
Follows straight way as,\\
\[(\inf_{n \in \mathbb{N}} f_n)^{-1}(-\infty, a) = 
    \bigcup_{n \in \mathbb{N}} f_n^{-1}(-\infty, a),\] and
\(\sup f_n = - \inf (- f_n)\).

\((\liminf_{n \to \infty} f_n)\) \((\limsup_{n \to \infty} f_n)\).
Follows as, by definition,
\[\liminf_{n \to \infty} f_n = \sup_{l \ge 1}\left(\inf_{k \ge l} f_k\right),\]
and
\[\limsup_{n \to \infty} f_n = \inf_{l \ge 1}\left(\sup_{k \ge l} f_k\right).\]
\qed

For the sake of completeness, we shall quickly introduce a method of
generating \(\sigma\)-algebras from functions. However, the proofs and
many properties are left on the problem sheet (sheet 3) as exercises.

\begin{definition}[\(\sigma\)-algebra Generated by Functions]
  Let \(X\) be a space, \((Y, \mathcal{A}_Y)\) a measurable space and 
  \(f : X \to Y\) a function. Define 
  \[\sigma(f) = \{f^{-1}(A) \mid A \in \mathcal{A}_Y\}.\]
\end{definition}

This is a \(\sigma\)-algebra on \(X\), and one can show that this is
indeed the smallest \(\sigma\)-algebra on \(X\) on which \(f\) is
measurable. Furthermore, for notation sake, if \(\{f_i \mid i \in I\}\)
is a family of functions, then
\[\sigma(f_i \mid i \in I) := \sigma\left(\bigcup_{i \in I} \sigma(f_i)\right).\]

\hypertarget{sequences-of-measurable-functions}{%
\subsection{Sequences of Measurable
Functions}\label{sequences-of-measurable-functions}}

A nice method to determine whether or not a function is measurable is to
show that it is a limit of measurable simple functions. Simple functions
are very useful in many instances and we will later also see their
applications in Lebesgue integration.

\begin{definition}[Simple Function]
  Let \(X\) be a set. A function \(s : X \to \mathbb{R}\) is called a simple 
  function (or a step function) if it takes on finitely many values. That is, 
  the set \(\{y \in \mathbb{R} \mid \exists\hspace{1mm} x \in X, y = s(x)\}\) is finite.
\end{definition}

Writing the image of a simple function \(s\) as
\(\{\alpha_1, \cdots, \alpha_l\}\), and by writing
\(A_i = s^{-1}(\{\alpha_i\})\) for all \(1 \le i \le l\), we see
straight way that \(\{A_i \mid i\}\) forms a partition of \(X\) and for
all \(x \in X\), \[s(x) = \sum_{i = 1}^l \alpha_i \mathbf{1}_{A_i}(x).\]
In particular, if \(\mathcal{A}\) is a \(\sigma\)-algebra over \(X\), by
recalling that a indicator function of the set \(A\) is measurable if
and only if \(A\) is measurable, we see that \(s\) is measurable if and
only if \(A_i\) is measurable for all \(i\).

\begin{theorem}[Approximation by Simple Functions]
  Let \((X, \mathcal{A})\) be a measurable space and let \(f : X \to [0, \infty]\) 
  be a function. Then \(f\) is measurable if and only if there exists a sequence 
  of measurable simple functions \(s_m : X \to [0, \infty)\), such that 
  for all \(x \in X\),
  \[0 \le s_1(x) \le s_2(x) \le \cdots \le f(x),\]
  and furthermore, \(f(x) = \lim_{n \to \infty}s_n(x)\).
\end{theorem}
\proof

If such a sequence exits, then, by the fact that the \(\liminf\) of
measurable functions is measurable, we have \(f\) is measurable.

Conversely, suppose \(f\) is measurable. Then, for \(n \ge 1\), we
define \[\phi_n : [0, \infty] \to \mathbb{R} : t \mapsto 
  \begin{cases}
    k2^{-n}, & k2^{-n} \le t < (k + 1)2^{-n}, k = 0, 1, \cdots, n2^{-n};\\
    n, & t \ge n.
  \end{cases}\] The functions \((\phi_n)\) are trivially measurable,
increasing and for all \(t < n\), we have
\[t - 2^{-n} \le \phi_n(t) \le t.\] Hence, we have
\(\lim_{n \to \infty} \phi_n(t) = t\) for all \(t \in [0, \infty]\).
Then, by defining \(s_n = \phi_n \circ f\), we find that this satisfy
our condition. \qed

\begin{definition}[Almost Everywhere]
  Let \((X, \mathcal{A}, \mu)\) be a measure space. A property \(P : X \to \text{Prop}\) 
  of \(X\) is said to hold \(\mu\)-almost everywhere (abbreviated as \(\mu\)-a.e.) if 
  the set \(\{x \in X \mid \neg P(x)\}\) is measurable and has \(\mu\)-measure 0.
\end{definition}

A commonly application of the above definition is the following notion
of convergence.

\begin{definition}[Convergence Almost Everywhere]
  Let \((f_n : X \to \mathbb{R})_{n = 1}^\infty\) be a sequence of measurable functions. 
  The sequence \((f_n)\) converges \(\mu\)-almost everywhere if 
  \[\mu\left(\{x \in X \mid \lim_{n \to \infty} f_n(x) \not\exists\}\right) = 0.\]
\end{definition}

We note that we assumed that the set
\(\{x \in X \mid \lim_{n \to \infty} f_n(x) \not\exists\}\) is
measurable. We shall prove this claim here.

\proof

It suffices to show the measurable of the complement, so let us consider
\(S := \{x \in X \mid \lim_{n \to \infty} f_n(x) \exists\}\). We see
that \(S\) is equivalent to the set of \(x\) such that \((f_n(x))\) is
Cauchy, so we have \[S = \bigcap_{K = 1}^\infty \bigcup_{N = 1}^\infty 
  \{x \in X \mid \forall n, m \ge N, |f_n(x) - f_m(x)| < 1 / K\}.\]
Indeed, taking the for all outside, we have,
\[S = \bigcap_{K = 1}^\infty \bigcup_{N = 1}^\infty 
  \bigcap_{n \ge N}\bigcap_{m \ge N}
  \{x \in X \mid |f_n(x) - f_m(x)| < 1 / K\},\] and so, it suffices to
show that \(\{x \in X \mid |f_n(x) - f_m(x)| < 1 / K\}\) is measurable
for appropriate \(K, N, n, m\). Thus, as
\[\{x \in X \mid |f_n(x) - f_m(x)| < 1 / K\} = (f_n - f_m)^{-1}(-1 / K, 1 / K),\]
since \(f_n\) and \(f_m\) are measurable,
\((f_n - f_m)^{-1}(-1 / K, 1 / K)\) is a measurable set, and we are
done! \qed

Throughout the remainder of this section, we consider
\(\Omega \subseteq \mathbb{R}^n\) measurable with respect to the
Lebesgue measure on the Borel \(\sigma\)-algebra with
\(\lambda(\Omega) < \infty\).

\begin{theorem}[Ergorov]
  Let \((f_n : \Omega \to \mathbb{R})_{n = 1}^\infty\) be a sequence of 
  measurable functions and \(f : \Omega \to \mathbb{R}\) be a measurable 
  function. Suppose that \(f_k \to f\) as \(k \to \infty\) almost everywhere 
  on \(\Omega\). Then, for all \(\delta > 0\), there exists a compact set 
  \(F \subseteq \Omega\) such that 
  \[\lambda(\Omega \setminus F) < \delta, \hspace{1mm} \text{and} \hspace{1mm} 
    \sup_{x \in F} |f_k(x) - f(x)| \to 0\]
  as \(k \to \infty\).
\end{theorem}

Conceptually, the Ergorov theorem tells us that for any sequence of
almost convergent measurable functions, there exists a ``large'' set
such that the convergence is uniform.

One cannot choose \(\delta = 0\) in general. Indeed, by considering the
sequence \(f_k(x) = x^k\) on \([0, 1]\), we see that
\(f_k \to \mathbf{1}_{\{1\}}\) pointwise. However, as we have see from
first year's analysis, this function does not uniformly converge on
\([0, 1]\) and so, we may only choose \(F = [0, 1 - \delta]\) for any
\(\delta \in (0, 1)\).

\proof (Ergorov). Let \(\delta > 0\) and for \(i, j \ge 1\), define
\[C_{ij} := \bigcup_{k = j}^\infty \{x \in \Omega \mid | f_k(x) - f(x)| > 2^{-i}\}.\]
We see that \(C_{ij}\) is measurable and
\(C_{i, j + 1} \subseteq C_{i, j}\). So, by the continuity of measures
from above, we have \[\lim_{j \to \infty} \lambda(C_{ij}) = 
    \lambda\left(\bigcap_{j = 1}^\infty C_{ij}\right) = 0\] since
\(f_k\) converges to \(f\) almost everywhere. Hence, by the definition
of the limit, there exists some \(J(i) \ge 1\) such that
\(\lambda(C_{i, J(i)}) <  \delta 2^{-i - 1}\). Then, by defining
\[A := \Omega \setminus \bigcup_{i = 1}^\infty C_{i, J(i)},\] we have
\[\lambda(\Omega \setminus A) \le \sum_{i = 1}^\infty \lambda(C_{i, J(i)})
    < \sum_{i = 1}^\infty \delta 2^{-i - 1} = \frac{\delta}{2}.\] Thus,
by recalling that for all \(\epsilon > 0\), there exists some
\(F \subset A\) closed such that \(\lambda(A \setminus F) < \epsilon\),
the result follows by taking \(\epsilon = \delta / 2\). \qed

The Ergorov theorem allows us to conclude a powerful result about
measurable functions. Indeed, by removing the compactness requirement
for \(F\), this theorem can be easily generalised to arbitrary measure
spaces by the same proof.

\begin{theorem}
  Let \(\Omega \subseteq \mathbb{R}^n\) with \(\lambda(\Omega) < \infty\).  
  If the function \(f : \Omega \to \mathbb{R}\) is measurable, then, for all 
  \(\delta > 0\), there exists \(F \subseteq \Omega\) compact such that 
  \(\lambda(\Omega \setminus F) < \delta\) and \(f\mid_F : F \to \mathbb{R}\) 
  is continuous.
\end{theorem}
\proof

Suppose first that \(f = s\) for some \(s\) a simple function. Then, we
can write \[s = \sum_{i = 1}^n \alpha_i \mathbf{1}_{A_i}\] for some
partition of \(\Omega\) -- \(\{A_i\}\). Now, since for all \(A_i\), we
may find \(F_i \subseteq A_i\) such that \(F_i\) is closed (and hence
compact) and \(\lambda(A_i \setminus F_i) < \delta 2^{-i}\), we have
\(F = \bigcup_{i = 1}^n F_i\) which suffices our condition.

Now, for the general case for \(f\), we apply the approximation theorem
for measurable functions. However, as the approximation theorem only
works for non-negative functions, let us write \(f = f^+ - f^-\) where
\(f^+\) and \(f^-\) are both non-negative. Now, by the approximation
theorem, there exists \((s_n^\pm)\) a sequence of simple functions
approximating \(f^\pm\), the sequence of function
\(s_n := s_n^+ - s_n^-\) is a simply function such that
\[\lim_{n \to \infty} s_n = \lim_{n \to \infty} s_n^+ - s_n^- = f^+ - f^- = f.\]
As we have already proved the theorem for simple functions, there exists
compact sets \(F_n\) such that
\(\lambda(\Omega \setminus F_n) < \delta 2^{-n - 1}\) and
\(s_n\mid_{F_n} : F_n \to \mathbb{R}\) is continuous. Furthermore, by
Ergorov's theorem, there exists some compact \(F_0 \subseteq \Omega\)
such that \(\lambda(\Omega \setminus F_0) < \delta / 2\) and
\[\sup_{x \in F_0} |s_n(x) - f(x)| \to 0,\] as \(n \to \infty\). Then,
by defining \[F := \bigcap_{i = 0}^\infty F_i,\] we have a compact set
(as the intersection of closed sets is closed) on which \(s_n \mid_F\)
is continuous and uniformly converge to \(f\mid_F\), and so \(f\mid_F\)
is continuous. Furthermore, since
\[\lambda(\Omega \setminus F) = \lambda\left(\Omega \setminus \bigcap F_i\right)
    = \lambda\left(\bigcup \Omega \setminus F_i\right) 
    \le \sum \lambda(\Omega \setminus F_i) < \delta / 2 + \delta / 2 = \delta,\]
we have the result. \qed

This is a powerful theorem that provides us with a necessary condition
on measurable functions however, it does not mean that measurable
function must be continuous at some point. Indeed, by recalling that
\(\mathbf{1}_{\mathbb{Q} \cap [0, 1]}\) on \(\Omega = [0, 1]\) is
measurable and nowhere continuous, we have a counterexample. This not
contradict our theorem however, since we can simply choose
\(F = [0, 1] \setminus \mathbb{Q}\) and so
\(\mathbf{1}_{\mathbb{Q} \cap [0, 1]} \mid_F = 0\). Thus, by any
sufficiently large compact subset of \(F\), the result follows.

\hypertarget{the-integral}{%
\subsection{The Integral}\label{the-integral}}

We will finally construct the integral on some arbitrary measure space
\((X, \mathcal{A}, \mu)\), in particular the case \(X = \mathbb{R}\),
\(\mathcal{A} = \mathcal{B}(\mathbb{R})\) and \(\mu = \lambda\). This
results in the Lebesgue integral and it turns out the Lebesgue integral
extend the Darboux integral, i.e.~the Lebesgue integral and the Darboux
integral agrees on Darboux integrable functions.

We will introduct the integral of \emph{suitable} measurable functions
in three steps:

\begin{enumerate}
  \item simple functions;
  \item non-negative functions (by approximation theorem);
  \item \textit{integrable} real-valued functions.
\end{enumerate}

As we shall see, while the first two definitions are applicable for all
appropriate measurable functions, the third definition applies only to
certain real-valued measurable functions in order to prevent cases such
as \(\infty - \infty\).

The integral of the simple functions is a one might expect.

\begin{definition}[Integral of Simple Functions]
  Let 
  \[S^+ := \{s : X \to [0, \infty) \mid s \text{ is simple and measurable}\},\]
  and for \(s \in S^+\), Wlog. we write \(s = \sum_{i = 1}^n \alpha_i \mathbf{1}_{A_i}\) 
  with \(\alpha_i \in (0, \infty)\) as a representation of \(s\) (not unique). 
  Then, for \(s \in S^+\) with representation \(s = \sum_{i = 1}^n \alpha_i \mathbf{1}_{A_i}\), 
  the integral of \(s\) with respect to the measure \(\mu\) is 
  \[\mu(s) \equiv \int_X s \dd \mu \equiv \int s \dd \mu := 
    \sum_{i = 1}^n \alpha_i \mu(A_i) \in [0, \infty].\]
\end{definition}

While this definition seems reasonable, as the representation of \(s\)
is not unique, we need to check whether or not it is well-defined.
Indeed, if
\(s = \sum_{i = 1}^n \alpha_i \mathbf{1}_{A_i} = \sum_{i = 1}^k \beta_i \mathbf{1}_{B_i}\),
Wlog. we may assume \(\bigcup A_i = \bigcup B_i = X\) since if
otherwise, we may add a term (without changing the value of the
integral) \(\alpha_{n + 1} A_{n + 1}\) with \(\alpha_{n + 1} = 0\) and
\(A_{n + 1} = X \setminus \bigcup A_i\). Then, by additivity,
\[\sum_{i = 1}^n\alpha_i \mu(A_i) = \sum_{i = 1}^n \alpha_i \sum_{j = 1}^k \mu(A_i \cap B_j) 
= \sum_{i = 1}^n \sum_{j = 1}^k \beta_j \mu(A_i \cap B_j) = \sum_{j = 1}^k \beta_j \mu(B_j),\]
where the second equality is true since on \(A_i \cap B_j\),
\(\alpha_i = \beta_j\), and so, the integral is well-defined.

\begin{lemma}
  Let \(f, g \in S^+\), then, for all \(\alpha, \beta \in [0, \infty)\), 
  \[\int (\alpha f + \beta g) \dd \mu = \alpha \int f \dd \mu + \beta \int g \dd \mu.\]
  Furthermore, if \(f \le g\), then 
  \[\int f \dd \mu \le \int g \dd \mu.\]
\end{lemma}
\proof

\(\int \alpha f \dd \mu = \alpha \int f \dd \mu\) immediately, so let us
show Linearity of addition. Write
\(f = \sum_{i = 1}^n \alpha_i \mathbf{1}_{A_i}\) and
\(g = \sum_{i = 1}^k \beta_i \mathbf{1}_{B_i}\); then, again, Wlog. we
may assume \(\bigcup A_i = \bigcup B_i = X\). Then,
\[f + g = \sum_{i = 1}^n \sum_{j = 1}^k (\alpha_i + \beta_j) \mathbf{1}_{A_i \cap B_j},\]
and hence, \[\begin{split}
    \int (f + g) \dd \mu 
      & = \sum_{i = 1}^n \sum_{j = 1}^k (\alpha_i + \beta_j) \mu(A_i \cap B_j)\\
      & = \sum \alpha_i \sum \mu(A_i \cap B_j) + \sum \beta_j \sum \mu(A_i \cap B_j)\\
      & = \sum \alpha_i \mu(A_i) + \sum \beta_j \mu(B_j)\\
      & = \int f \dd \mu + \int g \dd \mu.
  \end{split}\] (Monotonicity is left as an exercise.) \qed

\begin{definition}[Integral of Non-negative Functions]
  For \(f : X \to [0, \infty]\) a measurable function. Then the integral 
  of \(f\) is 
  \[\int f \dd \mu := \sup \left\{\int g \dd \mu \mid g \in S^+, g \le f\right\}.\]
\end{definition}

\begin{prop}
  Given \(f, g : X \to [0, \infty]\) measurable and \(\alpha, \beta \in [0, \infty)\),
  \[\int \alpha f + \beta g \dd \mu = \alpha \int f \dd \mu + \beta \int f \dd \mu.\] 
  Furthermore, if \(f \le g\) for all \(x \in X\) then, 
  \[\int f \dd \mu \le \int g \dd \mu.\]
\end{prop}
\proof

Follows by the combination of the next proposition with the
approximation of measurable functions by simple functions. \qed

\begin{prop}[Monotone Convergence]
  Let \(f : X \to [0, \infty]\) be a measurable function and 
  \((f_n : X \to [0, \infty])_{n = 1}^\infty\) be a sequence of measurable functions 
  such that \(f_n \uparrow f\). Then,
  \[\int f \dd \mu = \lim_{n \to \infty} \int f_n \dd \mu.\]
\end{prop}
\proof

First, we note that the limit \(\lim_{n \to \infty} \int f_n \dd \mu\)
exists since it is monotone and bounded above by \(\int f \dd \mu\). To
show the reverse inequality, it suffices to show that
\[\lim_{n \to \infty} \int f_n \dd \mu \ge \int g \dd \mu,\] for all
simple functions \(g \le f\). Let
\(g = \sum_{i = 1}^l \alpha_i \mathbf{1}_i\), and fix \(\epsilon > 0\)
with
\[G_n^\epsilon := \{x \in X \mid f_n(x) \ge (1 - \epsilon) g(x)\} \in \mathcal{A}.\]
Then, since \(f_n \uparrow f\), \((G_n^\epsilon)\) is a increasing
sequence of sets with \(\bigcup G_n^\epsilon = X\). Thus, for all
\(n \in \mathbb{N}\),
\[\int f_n \dd \mu \ge \int f_n \mathbf{1}_{G_n^\epsilon} \dd \mu \ge 
    \int (1 - \epsilon) g\mathbf{1}_{G_n^\epsilon} \dd \mu 
    = (1 - \epsilon) \int \sum_{i = 1}^l \alpha_i \mathbf{1}_{A_i \cap G_n^\epsilon} \dd \mu,\]
so, by the definition of the integral over simple functions, we have
\[\int f_n \dd \mu \ge (1 - \epsilon) \sum_{i = 1}^l \alpha_i \mu(A_i \cap G_n^\epsilon).\]
Thus, by taking \(n \to \infty\), by the continuity of measures, we have
\[\lim_{n \to \infty} \int f_n \dd \mu \ge 
    \lim_{n \to \infty} (1 - \epsilon) \sum_{i = 1}^l \alpha_i \mu(A_i \cap G_n^\epsilon)
    = (1 - \epsilon) \sum_{i = 1}^l \alpha_i \mu(A_i) = (1 - \epsilon) \int g \dd \mu.\]
Hence, as \(\epsilon\) is arbitrary, the reverse inequality is achieved.
\qed

We remark that in the definition of \(G_n^\epsilon\), the introduction
of \(\epsilon\) is necessary since, if \(g(x) = f(x)\) at some
\(x \in X\) while \(f_n(x) < f(x)\) for all \(n\),
\(x \not\in \bigcup G_n^\epsilon\), breaking our argument.

\begin{corollary}
  For \(f : X \to [0, \infty]\) measurable,
  \begin{itemize}
    \item \(f = 0\) \(\mu\)-a.e. \(\iff \int f \dd \mu = 0\);
    \item if \(\int f \dd \mu < \infty\), then \(f < \infty\), \(\mu\)-a.e.
  \end{itemize}
\end{corollary}
\proof \hspace{1mm}

\begin{enumerate}
\def\labelenumi{(\arabic{enumi})}
\item
  (\(\implies\)) By the approximation theorem, there exists a sequence
  of increasing measurable simple functions
  \((s_n : X \to [0, \infty])\) such that \(s_n \uparrow f\). Now, since
  \(s_n \le f\), \(s_n = 0\), \(\mu\)-a.e. since
  \[\{s_n \neq 0\} \subseteq \{f \neq 0\} \implies \mu(\{s_n \neq 0\}) 
      \le \mu(\{f \neq 0\}) = 0.\] and so,
  \(\int s_n \dd \mu = \sum \alpha_i \mu(A_i) = 0\) where \((A_n)\)
  forms a partition of \(\{s_n \neq 0\}\). Thus, by the above
  proposition,
  \[0 = \lim_{n \to \infty} \int s_n \dd \mu = \int \lim_{n \to \infty} s_n \dd \mu = 
      \int f \dd \mu.\] (\(\impliedby\)) Suppose otherwise, i.e.~there
  exists \(A \in \mathcal{A}\), such that \(\mu(A) \neq 0\) and for all
  \(a \in A\), \(f(a) \neq 0\). Then, I claim that there exists
  \(B \subseteq A\), \(B \in \mathcal{A}\) and there exists some
  \(\epsilon > 0\) such that \(\mu(B) > \epsilon\). Suppose otherwise,
  then for all \(\epsilon > 0\), \(\mu(f^{-1}[\epsilon, \infty]) = 0\).
  Thus, as \(f^{-1}[\epsilon, \infty] \uparrow f^{-1}(0, \infty]\), by
  the continuity of measures, \(\mu(f^{-1}(0, \infty]) = 0\) \#. So,
  choose \(\epsilon >0\) and \(B\) such that \(\mu(B) > 0\) and
  \(f(B) > \epsilon\). Then \(f \ge \epsilon\mathbf{1}_B\) on \(X\) and
  hence by monotonicity,
  \[\int f \dd \mu \ge \int \epsilon\mathbf{1}_B \dd \mu = \epsilon \mu(B) > 0,\]
  contradicting \(\int f \dd \mu = 0\).
\item
  If otherwise, then there exists \(A \in \mathcal{A}\),
  \(f(A) = \{\infty\}\) and \(\mu(A) > 0\). So,
  \(f \ge \infty \mathbf{1}_A\) (where \(\infty \times 0 := 0\)) and
  \[\int f \dd \mu \ge \int \infty \mathbf{1}_A \dd \mu = \infty \mu(A) = \infty.\]
  \qed
\end{enumerate}

This result allows us to strengthen the previous results regarding
monotonicity. For instance, monotonicity holds if \(f \le g\)
\(\mu\)-a.e. Indeed, if that is the case, then by defining
\(\hat f = f \times \mathbf{1}_{\{f \le g\}}\), we have
\[\int f \dd \mu - \int \hat f \dd \mu = \int f - \hat f \dd \mu = 0\]
since \(f - \hat f = 0\) \(\mu\)-a.e. Now, since \(\hat f \le g\)
everywhere on \(X\), the result follows.

Lastly, we may finally define the integral for real-valued functions.

\begin{definition}[\(\mu\)-integrable Functions]
  A measurable function \(f : X \to [-\infty, \infty]\) is called \(\mu\)-integrable 
  if \(\int |f| \dd \mu < \infty\). We write 
  \[\mathcal{L}^1(\mu) \equiv \mathcal{L}^1(X, \mathcal{A}, \mu) 
    := \{f : X \to [-\infty, \infty] \mid f \text{ measurable and } \mu \text{-integrable}\}\]
  for the space of measurable and integrable functions.
\end{definition}

\begin{definition}[Integral of Real-valued Functions]
  Let \(f \in \mathcal{L}^1(\mu)\). Then, the integral of \(f\) is 
  \[\int f \dd \mu := \int f^+ \dd \mu - \int f^- \dd \mu,\]
  where \(f = f^+ - f^-\). Furthermore, for \(A \in \mathcal{A}\), we define
  \[\int_A f \dd \mu := \int f \mathbf{1}_A \dd \mu.\]
  (Hence \(\int f \dd \mu = \int_X f \dd \mu\)).
\end{definition}

\begin{theorem}[Properties of the Integral]
  Let \(f, g \in \mathcal{L}^1(\mu)\), then 
  \begin{itemize}
    \item (Monotonicity) \(f \le g\) \(\mu\)-a.e. \(\implies \int f \dd \mu 
      \le \int g \dd \mu\). In particular, if \(f = g\) \(\mu\)-a.e. then 
      \(\int f \dd \mu = \int g \dd \mu\);
    \item (Triangle inequality) \(\left| \int f \dd \mu \right| \le \int |f| \dd \mu\);
    \item (Linearity) for all \(\alpha, \beta \in \mathbb{R}\), then 
      \(\alpha f + \beta g \in \mathcal{L}^1(\mu)\) and 
      \(\int \alpha f + \beta g \dd \mu = \alpha \int f \dd \mu + \beta \int g \dd \mu\).
  \end{itemize}
\end{theorem}
\proof

Follows easily from the definition and the previous properties for
non-negative functions. \qed

In the case that
\((X, \mathcal{A}, \mu) = (\mathbb{R}^n, \mathcal{B}(\mathbb{R}^n), \lambda)\)
with \(\lambda\) denoting the Lebesgue measure, the corresponding
integral \(\int f \dd \lambda\) is called the \textbf{Lebesgue
integral}. In fact, one commonly ``complete the space'' by adding all
subsets of \(\lambda\)-null sets, i.e.~one considers \(\lambda\) on the
``completed'' \(\sigma\)-algebra
\[\mathcal{B}^*(\mathbb{R}^n) := \sigma(\mathcal{B}(\mathbb{R}^n) \cup \mathcal{N}),\]
where
\(\mathcal{N} := \{A \subseteq \mathbb{R}^n \mid \exists N \in  \mathcal{B}(\mathbb{R}^n), A \subseteq N \wedge \lambda(N) = 0 \}\).
Furthermore, the Lebesgue integral extends the Darboux integral in the
following sense:

\begin{prop}[Extension of Darboux Integral]
  Let \(f : I \to \mathbb{R}\) be Darboux-integrable on \(I = [a, b]\) with 
  \[\left|\int_a^b f(x) \dd x\right| < \infty.\]
  Then, \(f\mathbf{1}_I\) is Lebesgue integrable and 
  \[\int_I f \dd \lambda = \int_a^b f(x) \dd x.\]
\end{prop}
\proof

See problem sheet. \qed

Furthermore, this extension is a strict extension, as in the Lebesgue
integral is strictly stronger than the Darboux integral. Indeed, by
recalling the motivational example, we saw that
\(\mathbf{1}_{\mathbb{Q} \cap [0, 1]}\) we not Darboux integrable by, we
see now that this is easily Lebesgue integrable as it is simply
\[\int \mathbf{1}_{\mathbb{Q} \cap [0, 1]} \dd \mu = \mu(\mathbb{Q} \cap [0, 1]) = 0.\]

Now consider when \(X = \mathbb{N}\), \(\mathcal{A} = \mathcal{P}(X)\)
and \(\mu =\) the counting measure, then, we define
\[l^1 := \mathcal{L}^1(\mu) = \left\{ a : \mathbb{N} \to \mathbb{R} \mid
 \sum |a_n| < \infty\right\},\] and so, \(l^1\) is simply the space of
absolutely convergent sequences with \(\int a \dd \mu = \sum a_n\).

Lastly, returning to our example of applications of measure theory, if
\(\mu = \mathbb{P}\) -- the probability measure and
\(f \in \mathcal{L}^1(\mathcal{P})\), then one usually writes
\[\mathbb{E}[f] := \int_\Omega f \dd \mathbb{P},\] the expectation of
\(f\) with respect to \(\mathbb{P}\).

\hypertarget{convergence-theorems}{%
\subsection{Convergence Theorems}\label{convergence-theorems}}

As before, let \((X, \mathcal{A}, \mu)\) be a measure space. The
convergence theorems regard the interchange of limits and integrals. In
fact, we have already seen on of such theorems -- the monotone
convergence theorem, and as an application, we obtain the following
lemma.

\begin{prop}[Fatou's Lemma]
  Let \(f_n : X \to [0, \infty]\) for all \(n \in \mathbb{N}\) be a sequence 
  of measurable functions. Then 
  \[\int \liminf_{n \to \infty} f_n \dd \mu \le \liminf_{n \to \infty} \int f_n \dd \mu.\]
\end{prop}
\proof

For \(n \in \mathbb{N}\), define \(g_n : X \to [0, \infty]\) by
\[g_n(x) := \inf_{k \ge n} f_k(x).\] We see that \(g_n\) is measurable
and \(g_n \le f_k\) for all \(k \ge n\) and hence, by monotonicity,
\[\int g_n \dd \mu \le \inf_{k \ge n} \int f_k \dd \mu.\] Now, since
\(g_n\) is monotonically increasing, by the monotone convergence
theorem, we have \[\int \liminf_{n \to \infty} f_n \dd \mu 
    = \int \lim_{n \to \infty} g_n \dd \mu 
    = \lim_{n \to \infty} \int g_n \dd \mu 
    \le \lim_{n \to \infty} \inf_{k \ge n} \int f_k \dd \mu.\] \qed

We note that we have not assumed that \(f_n\) is convergent, and so,
Fatou's lemma is useful in that it can apply to a wide range of
sequences of functions.

\begin{theorem}[Lebesgue Dominated Convergence Theorem]
  Let \(g : X \to [0, \infty]\) be integrable, i.e. \(g \in \mathcal{L}^1(\mu)\), 
  and \(f, f_n : X \to [- \infty, \infty]\) for \(n \ge 1\) be measurable functions 
  such that \(f_n \to f\) \(\mu\)-almost everywhere and 
  \[| f_n(x) | < g(x)\]
  for all \(x \in X\). Then, 
  \[\left| \int f_n \dd \mu - \int f \dd \mu \right| \le \int |f_n - f| \dd \mu \to 0,\]
  as \(n \to \infty\).
\end{theorem}
\proof

Straight, we have \(f_n\) and \(f\) are integrable since both are
bounded by \(g\), \(\mu\)-a.e. and so, their integral are finite (so the
theorem is well-defined). The inequality is simply the
triangle-inequality for integrals, and so, it suffices to show
\(\int |f_n - f| \dd \mu \to 0\) as \(n \to \infty\).

Thus, by applying Fatou's lemma on \(2g - |f_n - f|\) (which is a
increasing sequence of non-negative measurable functions), we have
\[\int 2g \dd \mu = \int \liminf_{n \to \infty} \{2g - |f_n - f|\} \dd \mu \le \liminf_{n \to \infty} 
    \int 2g - |f_n - f| \dd \mu, \] since \(2g - |f_n - f| \to 2g\),
\(\mu\)-a.e. Thus, by applying linearity, we have
\[\int 2g \dd \mu \le \int 2g \dd \mu - \liminf_{n \to \infty} \int |f_n - f| \dd \mu.\]
So, \[0 \le \limsup_{n \to \infty} \int |f_n - f| \dd \mu \le 0\] and
the result follows. \qed

Straight away we see that the dominated convergence theorem shows that,
for appropriate sequences of functions \(f_n \to f\),
\[\lim_{n \to \infty} \int f_n \dd \mu = \int f \dd \mu.\]

Convergence in measure is a weaker condition than convergence almost
everywhere. However, as we shall see on the problem sheet, the dominated
convergence theorem holds for this weaker condition of convergence.

\begin{definition}[Convergence in Measure]
  Let \(f : X \to \mathbb{R}\), \(f_n : X \to [-\infty, \infty]\) for all \(n \in \mathbb{N}\)
  be measurable. Then \(f_n\) converges to \(f\) is measure if for all \(\epsilon > 0\), 
  \[\mu(\{x \in X \mid | f_n(x) - f(x) | > \epsilon\}) \to 0\]
  as \(n \to \infty\).
\end{definition}

\begin{prop}
  Let \(f, f_n : X \to \mathbb{R}\) for \(n \in \mathbb{N}\) be measurable with 
  \(\mu(X) < \infty\). Then, 
  \begin{itemize}
    \item if \(\int |f_n - f| \dd \mu \to 0\), then \(f_n \to f\) in measure;
    \item if \(f_n \to f\) \(\mu\)-a.e. then \(f_n \to f\) in measure;
    \item if \(f_n \to f\) in measure, then there exists a subsequence 
    \(\Lambda \subseteq \mathbb{N}\) such that \(f_n \to f\) \(\mu\)-a.e. as 
    \(n \in \Lambda \to \infty\).
  \end{itemize}
\end{prop}
\proof

See problem sheet 4 and 6. \qed

\begin{definition}[Density]
  Let \(f : X \to [0, \infty)\) be measurable and \(\mu\) is a measure on 
  \((X, \mathcal{A})\). Then, we can construct a new measure \(\nu\) where 
  \[\nu(A) := \int_A f \dd \mu,\]
  for all \(A \in \mathcal{A}\) (easy proof). This measure \(\nu\) is said to have a 
  density with respect to \(\mu\) and \(f\) is a density. For shorthand, we often 
  write \(\nu = f \mu\) and \(f = \dv{\nu}{\mu}\).
\end{definition}

\begin{definition}[Absolutely Continuous]
  Let \(\mu, \nu\) be two measures on \((X, \mathcal{A})\). Then \(\nu\) is 
  absolutely continuous with respect to \(\mu\) (denoted \(\nu \ll \mu\)) if 
  \(\nu(A) = 0\) for all \(A \in \mathcal{A}\) with \(\mu(A) = 0\).
\end{definition}

The reason for this definition is the following.

\begin{prop}
  Let \(f \in \mathcal{L}^1(\mu)\), then for all \(\epsilon > 0\), there exists 
  some \(\delta > 0\) such that for all \(A \in \mathcal{A}\), \(\mu(A) < \delta\), 
  we have \(\int_A |f| \dd \mu < \epsilon\).
\end{prop}
\proof

See problem sheet 5. \qed

Clearly \(\nu = f\mu\) implies \(\nu \ll \mu\) since for all
\(A \in \mathcal{A}\), \(\mu(A) = 0\) implies that
\(\nu (A) = \int_A |f| \dd \mu < \epsilon\) for all \(\epsilon > 0\) and
so, a measure is absolutely continuous if it has a density. Indeed, as
we shall see later (in the Radon - Nikodym theorem), the reverse is also
true -- every absolutely continuous measure has a density. Thus, in
light of this, we see that a measure \(\nu\) is absolutely continuous is
equivalent to saying that there exists some \(\mu\) such that for all
\(\epsilon > 0\) there exists a \(\delta > 0\) such that for all
\(A \in \mathcal{A}\), \(\mu(A) < \delta\), we have
\(\nu(A) < \epsilon\) (provided \(X\) has finite measure).

\begin{definition}[Uniformly Absolutely Continuous Integrals]
  Let \(\mathcal{F} \subseteq \mathcal{L}^1(\mu)\). The family \(\mathcal{F}\) is 
  said to have uniformly absolutely continuous integrals if for all \(\epsilon > 0\), 
  there exists some \(\delta > 0\), such that for all \(f \in \mathcal{F}\), 
  \(A \in \mathcal{A}\) such that \(\mu(A) < \delta\), we have 
  \[\int_A |f| \dd \mu < \epsilon.\]
\end{definition}

Straight away, we see that any singleton \(\mathcal{F} = \{f\}\) has
uniformly absolutely continuous integrals. Indeed, by induction, this is
also true for any finite families \(\mathcal{F}\) by induction.

\begin{theorem}[Vitali]
  Let \(\mu(X) < \infty\), \(f, f_n : X \to \mathbb{R}\) be measurable for all 
  \(n \in \mathbb{N}\). Then, the following are equivalent:
  \begin{itemize}
    \item \(f_n \to f\) in measure and \(\mathcal{F} := \{f_n \mid n \in \mathbb{N}\}\) 
      has uniformly absolutely continuous integrals;
    \item \(\int |f_n - f| \dd \mu \to 0\) as \(n \to \infty\).
  \end{itemize}
\end{theorem}

We see that the requirements for the dominated convergence theorem
implies Vitali's theorem since if there exists such a dominating \(g\),
for all \(\epsilon > 0\), we can choose \(\delta > 0\) to be that of
\(g\)'s. So, for all \(A \in \mathcal{A}\), if \(\mu(A) < \delta\),
\[\int_A |f_n| \dd \mu \le \int_A g \dd \mu < \epsilon,\] for all
\(n \in \mathbb{N}\).

\proof (Vitali).

(\(\impliedby\)) \(f_n \to f\) in measure by proposition above and so,
it suffices to show that \(\mathcal{F}\) has uniformly absolutely
continuous integrals.

For all \(\epsilon > 0\), choose \(n_0 \in \mathbb{N}\) such that
\[\int |f_n - f| \dd\mu < \frac{\epsilon}{2}\] for all \(n \ge n_0\).
Then, by defining \(\mathcal{F}' := \{f, f_1, \cdots, f_{n_0}\}\), since
\(\mathcal{F}'\) is finite, it has uniformly absolutely continuous
integrals. Thus, there exists some \(\delta > 0\) such that for all
\(A \in \mathcal{A}\) with \(\mu(A) < \delta\),
\[\int_A |f| \dd \mu < \frac{\epsilon}{2}, \text{ and } 
    \max_{n \le n_0} \int_A |f_n| \dd\mu < \frac{\epsilon}{2}.\] Hence,
by choosing this to be our \(\delta\), for \(n > n_0\),
\[\int_A |f_n| \dd \mu = \int_A |f_n - f + f| \dd \mu 
    \le \int_A |f_n - f| \dd \mu + \int_A |f| \dd \mu < \frac{\epsilon}{2} 
    + \frac{\epsilon}{2} = \epsilon,\] and we have \(\mathcal{F}\) has
uniformly absolutely continuous integrals.

(\(\implies\)) By contradiction, assume
\(\limsup_{n \to \infty} \int |f_n - f| \dd\mu > 0\). Then, there exists
some subsequence \(\Lambda \subseteq \mathbb{N}\), such that
\[\lim_{n \in \Lambda \to \infty}\int |f_n - f| \dd \mu > 0,\] and
\(f_n \to f\) \(\mu\)-a.e. as \(n \in \Lambda \to \infty\). Now, since
\(\mathcal{F} \cup \{f\}\) has uniformly absolutely continuous
integrals, for all \(\epsilon > 0\), there exists some \(\delta > 0\)
such that for all \(A \in \mathcal{A}\), \(\mu(A) < \delta\), we have
\[\int_A |f| \dd\mu < \frac{\epsilon}{3}, \text{ and } \int_A |f_n| \dd\mu < \frac{\epsilon}{3}\]
for all \(n \in \mathbb{N}\). Applying Ergorov's theorem to
\((f_n)_{n \in \Lambda}\), one finds a measurable set \(F\) such that
\(\mu(X \setminus F) < \delta\) and
\[\sup_{x \in F} |f_n(x) - f(x)| \to 0,\] as
\(n \in \Lambda \to \infty\). Thus, choosing \(n_0\) such that
\[\sup_{x \in F} |f_n(x) - f(x)| < \frac{\epsilon}{3 \mu(X)},\] for all
\(n \in \lambda_{\ge n_0}\), it follows that for all
\(n \in \lambda_{\ge n_0}\),
\[\int |f_n - f| \dd \mu = \int |f_n - f| \mathbf{1}_F \dd \mu + 
    \int |f_n - f| \mathbf{1}_{X \setminus F} \dd\mu \le 
    \frac{\epsilon}{3\mu(X)} \mu(F) + 
    \frac{\epsilon}{3} + \frac{\epsilon}{3} \le \epsilon,\] which
contradicts our assumption. \qed

\hypertarget{lp-spaces}{%
\subsection{\texorpdfstring{\(L^p\)
Spaces}{L\^{}p Spaces}}\label{lp-spaces}}

\(L^p\) spaces are amongst the most important vector spaces of functions
in analysis and we shall in this section look at some of their
properties.

\begin{definition}
  Let \((X, \mathcal{A}, \mu)\) be a measure space and \(1 \le p \le \infty\).  
  Then, for \(f : X \to [- \infty, \infty]\) measurable, define 
  \[\|f\|_{L^p(\mu)} := \left(\int |f|^p \dd \mu\right)^{1 / p}\]
  if \(p < \infty\), and
  \[\|f\|_{L^\infty(\mu)} := \inf \{ C \in \mathbb{R} \mid |f| \le C, \mu-\text{a.e.}\},\]
  if \(p = \infty\). With that, we define \(\mathcal{L}^p\) to be the space
  \[\mathcal{L}^p := \{f : X \to [-\infty, \infty] \mid f \text{ measurable}, 
    \|f\|_{L^p(\mu)} < \infty\}.\]
\end{definition}

For shorthand, whenever the measure is clear from the context, we denote
the \(L^p\) norm as \(\| \cdot \|_p\).

Sometimes, the norm \(\| \cdot \|_{L^\infty(\mu)}\) is refereed to as
the essential supremum norm.

Clearly, for all \(f \in \mathcal{L}^\infty(\mu)\), we have
\[|f(x)| \le \|f\|_{L^\infty(\mu)}\] \(\mu\)-a.e. Indeed, by definition
of the infimum, we can construct the sequence
\((C_k)_{k = 0}^\infty \subseteq \{ C \in \mathbb{R} \mid |f| \le C, \mu-\text{a.e.}\}\)
such that \(C_k \downarrow \|f\|_{L^\infty(\mu)}\). Hence, we have
\(\{x \mid |f(x)| > C_k\} \uparrow \{x \mid |f(x)| > \|f\|_{L^\infty(\mu)}\}\),
and so, by continuity of measures,
\[\mu(\{x \mid |f(x)| > \|f\|_{L^\infty(\mu)}\}) = 
  \lim_{k \to \infty}\mu(\{x \mid |f(x)| > C_k\}) = 0.\] We would like
to turn \(\mathcal{L}^p(\mu)\) into a normed vector space but the
obvious choice for the norm -- \(\| \cdot \|_{L^p(\mu)}\) is problematic
since \(\| \cdot \|_{L^p(\mu)}\) is not
positive-definite\footnote{\(\| f \|_{L^p(\mu)} > 0\) for
all \(f \neq 0\)} as if \(f = g\) \(\mu\)-a.e. then \(\|f - g\|_p = 0\)
but \(f - g \neq 0\). To fix this, we quotient \(\mathcal{L}^p(\mu)\) by
the equivalence relation by \(f \sim g \iff f = g\) \(\mu\)-a.e. With
that, we may define the \(L^p\) space.

\begin{definition}[\(L^p(\mu)\) Space]
  Let \((X, \mathcal{A}, \mu)\) be a measure space and \(1 \le p \le \infty\). 
  Then, the \(L^p\) space if defined to be the vector space
  \[L^p(\mu) := \{[f] \mid f \in \mathcal{L}^p(\mu)\}\]
  equipped with the norm \(\|[f]\|_{L^p(\mu)} := \inf_{g \in [f]} \|g\|_{L^p(\mu)} 
  = \|f\|_{L^p(\mu)}\).
\end{definition}

As a convention, we often identify the equivalent class \([f]\) by some
choice \(f \in [f]\), thus writing \(f \in L^p(\mu)\). This is justified
as long as any manipulations we apply on this equivalence class
traverses across equality \(\mu\)-a.e.

\begin{lemma}[Young's Inequality]
  Let \(1 < p, q < \infty\) be conjugate, i.e. \(1 / p + 1 / q = 1\). Then 
  \[ab \le \frac{a^p}{p} + \frac{b^q}{q},\]
  for all \(a, b \ge 0\).
\end{lemma}
\proof

See exercises. \qed

\begin{corollary}[Hölder's Inequality]
  Let \(1 \le p, q \le \infty\) be conjugate and \(f \in L^p(\mu)\) and \(g \in L^q(\mu)\). 
  Then \(fg \in L^1(\mu)\) and 
  \[\|fg\|_{L^1(\mu)} \le \|f\|_{L^p(\mu)} \|g\|_{L^q(\mu)}.\]
\end{corollary}
\proof

Wlog. assume \(p \le q\). If \(p = 1\) and \(q = \infty\), then the
inequality follows as \(|fg| = |f| |g| \le |f|\|g\|_\infty\)
\(\mu\)-a.e. so let us suppose \(p, q < \infty\).

In the case that \(\|f\|_p = \|g\|_p = 1\), we have
\[\int |fg| \dd \mu \le \int \frac{|f|^p}{p} + \frac{|g|^q}{q} \dd \mu
    = \frac{1}{p} \|f\|^p_p + \frac{1}{q} \|g\|^q_q = \frac{1}{p} + \frac{1}{q} = 1.\]
For the general case, we can simply reduce the inequality to the
previous case by normalising the functions, i.e.~consider the inequality
on \(\tilde f = f / \|f\|_p\) and \(\tilde g = g / \|g\|_q\). \qed

\begin{corollary}[Minkowski's Inequality]
  Let \(1 \le p \le \infty\) and \(f, g \in L^p(\mu)\). Then 
  \[f + g \in L^p(\mu) \text{ and } \|f + g\|_{L^p(\mu)} \le 
    \|f\|_{L^p(\mu)} + \|g\|_{L^p(\mu)}.\]
\end{corollary}
\proof

See exercises. \qed

\begin{theorem}
  The space \(L^p(\mu)\) is a complete, normed vector space (\(\equiv\) a Banach space) 
  for all \(1 \le p \le \infty\).
\end{theorem}
\proof

Clearly, we have positive definiteness since
\(\|f\|_p = 0 \iff f \in [0] \iff  [f] = [0]\). Furthermore, linearity
of the norm is also clear by linearity of the integrals. Thus, as the
triangle inequality is simple Minkowski's inequality, we have
\(L^p(\mu)\) forms a normed vector space.

Let \((f_n)_{n = 1}^\infty\) be a Cauchy sequence in \(L^p\) where
\(p < \infty\), then, it suffices to show that \((f_n)\) converges in
\(L^p\). Let \(1 \le p < \infty\) and choose a subsequence \((f_{n_k})\)
such that \(\|f_n - f_m\|_p < 2^{-k}\) for all \(k \ge 1\),
\(m, n \ge n_k\). Define
\(g_l = \sum_{k = 1}^l |f_{n_{k + 1}} - f_{n_k}|\) and \(g = g_\infty\),
then, since \(0 \ge g_l \uparrow g\), by the monotone convergence
theorem,
\[\|g\|_p = \left(\int |g|^p \dd\mu\right)^{1 / p} = \lim_{l \to \infty}
   \left(\int |g_l|^p \dd\mu\right)^{1 / p} \le 
   \lim_{l \to \infty} \sum_{k = 1}^l \|f_{n_{k + 1}} - f_{n_k}\| < \infty,\]
and hence, \(g \in L^p(\mu)\). It follows that
\[f(x) := f_{n_1}(x) + \sum_{k = 1}^\infty(f_{n_{k + 1}}(x) - f_{n_k}(x))\]
whenever \(g(x) < \infty\) and 0 otherwise is well-defined. By observing
that the definition of \(f(x)\) is a telescoping sum for finitely many
terms, we have
\[f(x) = f_{n_j}(x) + \sum_{k = j}^\infty(f_{n_{k + 1}}(x) - f_{n_k}(x))\]
for all \(j \in \mathbb{N}\). Thus, for all \(k \in \mathbb{N}\), we
have
\[|f(x) - f_{n_k}(x)| = \left| \sum_{l = k}^\infty f_{n_{k + 1}}(x) - f_{n_k}(x)\right| 
    \le g(x).\] \(\mu\)-a.e. Thus, by the (convergence in measure
version) dominated convergence theorem, we have \(f \in L^p\) and
\[\int|f - f_{n_k}|^p \dd \mu \to 0.\] Then \(f_n \to f\) in general by
Minkowski's inequality as
\[\|f - f_n\|_p \le \|f - f_{n_k}\|_p + \|f_{n_k} - f_n\| \le 2^{-k} + \|f - f_{n_k}\|_p,\]
for some appropriate \(n_k > n\). Thus, by taking \(n \to \infty\), the
result follows.

For the case that \(p = \infty\), the result follows easily from the
definition (exercise). \qed

The \(L^p\) space might appear ``vast'' but for instance, we have (proof
omitted) that the space of continuous functions with compact support
\(C^\circ_c(\mathbb{R}^n)\) is dense in \(L^p(\mathbb{R}^n)\) and so, we
may approximate every function in \(L^p\) by a sequence of continuous
functions with compact support, providing us with a easier mental image
to work with.

\newpage

\hypertarget{product-measure-multiple-integrals}{%
\section{Product Measure \& Multiple
Integrals}\label{product-measure-multiple-integrals}}

\hypertarget{product-measures}{%
\subsection{Product Measures}\label{product-measures}}

As we have seen from the problem sheet, we can create product
\(\sigma\)-algebra using existing \(\sigma\)-algebras. It turns out we
can achieve the same for measures with product measures.

\begin{definition}[Product \(\sigma\)-algebra Between Two Measure Spaces]
  Let \((X_i, \mathcal{A}_i, \mu_i), i = 1, 2\) be two measure spaces. Furthermore,
  let \(X := X_1 \times X_2\) and \(Z_i\) be the projection map onto \(X_i\) for 
  \(i = 1, 2\). Then, the product \(\sigma\)-algebra on \(X\) is 
  \[\mathcal{A} = \mathcal{A}_1 \otimes \mathcal{A}_2 := \sigma(Z_1, Z_2).\]
\end{definition}

We see straight away that this can be generalised to \(n\) measure
spaces.

\begin{lemma}
  Let \((X_i, \mathcal{A}_i, \mu_i), i = 1, 2\) be two measure spaces, then
  \[\mathcal{A}_1 \otimes \mathcal{A}_2 
    = \sigma(\{A_1 \times A_2 \mid A_i \in \mathcal{A}_i, i = 1, 2\}).\]
\end{lemma}
\proof

See problem sheet 2. \qed

\begin{definition}[Rectangle]
  We call a set \(R \subseteq X_1 \times X_2\) a rectangle if there exists 
  \(A_i \in \mathcal{A}_i\) for \(i = 1, 2\) such that \(R = A_1 \times A_2\).
\end{definition}

To define product measures, we shall again use the Hahn-Carathéodory
extension and extend an outer measure to a proper measure on the product
space. Define the algebra of elementary figures
\[\mathcal{R} := \left\{\bigcup_{i = 1}^m R_i 
  \mid R_i \text{ are disjoint rectangles.}\right\}.\] Furthermore, we
define \[\rho(R) := \sum_{i = 1}^m \mu_1(A_i) \mu_2(B_i),\] if
\(R = \bigcup_{i = 1}^m A_i \times B_i \in \mathcal{R}\).

\begin{lemma}
  \(\rho\) forms a premeasure on \(\mathcal{R}\).
\end{lemma}
\proof

Evidently \(\rho(\varnothing) = 0\) since
\(\varnothing = \varnothing \times \varnothing\).

Let \(\{R_k\}_{k = 1}^\infty\) be a sequence of disjoint rectangles and
denote \(R := \bigcup_{k = 1}^\infty R_k\). Then we need to prove that
\[\rho(R) = \sum_{k = 1}^\infty \rho(R_k),\] provided
\(\bigcup_{k = 1}^\infty R_k \in \mathcal{R}\). Assuming \(R\) is a
rectangle, we note that
\[\rho(R) = \int \left(\int \mathbf{1}_R(x_1, x_2) \dd \mu_1(x_2)\right) \dd \mu_2(x_2).\]
Indeed, if \(R = A_1 \times A_2\), then for every \(x_2 \in X_2\),
\(x_1 \mapsto \mathbf{1}_R(x_1, x_2) = \mathbf{1}_{A_1}(x_1) \mathbf{1}_{A_2}(x_2)\)
is simply, and hence \(\mathcal{A_1}\) measurable and thus, integrable.
With that, we have \[\int \mathbf{1}_R(x_1, x_2) \dd \mu_1(x_1) = 
    \mathbf{1}_{A_2}(x_2)\ \mu(A_1).\] So,
\[\int \left(\int \mathbf{1}_R(x_1, x_2) \dd \mu_1(x_2)\right) \dd \mu_2(x_2) = 
    \mu(A_1)\mu(A_2) = \rho(R).\] Now, write
\(R = \bigcup_{k = 1}^\infty R_k\), we have
\(\mathbf{1}_R =  \sum_{k = 1}^\infty \mathbf{1}_{R_k} = \lim_{n \to \infty} \sum_{k = 1}^n \mathbf{1}_{R_k}\).
As the limit of measurable functions is measurable, we have the
projection map
\[x_1 \mapsto \mathbf{1}_R(x_1, x_2) = \lim_{n \to \infty} \sum_{k = 1}^n \mathbf{1}_{R_k}(x_1, x_2),\]
is \(\mathcal{A}_1\)-measurable and similarly,
\[x_2 \mapsto \sum_{k = 1}^\infty \int \mathbf{1}_{R_k}(x_1, x_2) \dd \mu_1(x_1),\]
is \(\mathcal{A}_2\)-measurable. So, \[\begin{split}
    \rho(R) & = \int \left(\int \mathbf{1}_R(x_1, x_2) \dd \mu_1(x_2)\right) \dd \mu_2(x_2)\\
    & = \int \left(\int \sum_{k = 1}^\infty \mathbf{1}_{R_k}(x_1, x_2) \dd \mu_1(x_2)\right) 
      \dd \mu_2(x_2)\\
    & = \int \left(\lim_{n \to \infty} \int \sum_{k = 1}^n 
      \mathbf{1}_{R_k}(x_1, x_2) \dd \mu_1(x_2)\right) \dd \mu_2(x_2)\\
    & = \sum_{k = 1}^\infty \int \left(\int \mathbf{1}_{R_k}(x_1, x_2) \dd \mu_1(x_2)\right) \dd \mu_2(x_2)
    = \sum_{k = 1}^\infty \rho(R_k) \end{split}\] where we use monotone
convergence theorem and linearity. \qed

With this lemma at our disposal, we can finally define the product
measure.

\begin{definition}
  Let \((X_i, \mathcal{A}_i, \mu_i), i = 1, 2\) be \(\sigma\)-finite measure 
  spaces. Then, the product measure \(\mu_1 \otimes \mu_2\) is the unique 
  measure on \((X_1 \times X_2, \mathcal{A}_1 \times \mathcal{A}_2)\) obtained 
  by the Hahn-Carathéodory extension of the premeasure \(\rho\). 

  In particular \((\mu_1 \otimes \mu_2)(A_1 \times A_2) = \mu_1(A_1) \mu_2(A_2)\) 
  for any rectangle \(A_1 \times A_2\).
\end{definition}

We note that we assumed that the resulting product measurable space is
also \(\sigma\)-finite in order to obtain uniqueness. This is fine since
due to the property that
\((\mu_1 \otimes \mu_2)(A_1 \times A_2) = \mu_1(A_1) \mu_2(A_2)\), the
elements of the resulting product cover has measure equal to the product
of two finite number, and hence, is also finite.

Consider \(\lambda^n\) as the Lebesgue measure on \(\mathbb{R}^n\).
Then, if \(\mu_1 = \mu_2 = \lambda^1\). Then,
\(\mu_1 \otimes \mu_2 = \lambda^2\). Indeed, one has
\[\rho([a_1, b_1] \times [a_2, b_2]) = (b_1 - a_1)(b_2 - a_2) 
  = \tilde \lambda^2([a_1, b_1] \times [a_2, b_2]),\] and so, they agree
for elementary figures. Thus, by uniqueness, they are equal. With this,
it is not difficult to see that
\[\lambda^n \otimes \lambda^m = \lambda^{n + m},\] for all
\(n, m \ge 1\).

With little more effort, for an arbitrary index set \(I\) given
\(\sigma\)-finite measure spaces
\((X_i, \mathcal{A}_i, \mu_i), i \in I\), we can define the product
measure \(\bigotimes_{i \in I} \mu_i\) on
\(X := \{(x_i \mid i \in I) \mid x_i \in X_i\}\) endowed with the
\(\sigma\)-algebra \(\sigma(Z_i \mid i \in I)\) where \(Z_i\) is the
\(i\)-th projection map such that for all \(J \subseteq I\),
\(|J| < \infty\), \(A_j \in \mathcal{A}_j\), \(j \in J\), we have
\[\bigotimes_{i \in I}\mu_i(\{(x_j \mid j \in J) \mid x_j \in A_j\}) 
  = \prod_{j \in J} \mu_j(A_j).\]

\hypertarget{fubinis-theorem}{%
\subsection{Fubini's Theorem}\label{fubinis-theorem}}

We now discuss Fubini's theorem which under suitable assumptions,
justifies the exchange of order of integrals.

\begin{theorem}[Fubini's Theorem]
  Let \((X_i, \mathcal{A}_i, \mu_i), i = 1, 2\) be \(\sigma\)-finite measure spaces 
  and let \(f : X_1 \times X_2 \to [-\infty, \infty]\) be measurable with respect 
  to \(\mathcal{A}_1 \otimes \mathcal{A}_2\). If \(f \ge 0\) or 
  \(f \in \mathcal{L}^{1}(\mu_1 \otimes \mu_2)\), then 
  \[x_1 \mapsto \int f(x_1, x_2) \dd \mu_2(x_2)\]
  is \(\mathcal{A}_1\)-measurable,
  \[x_2 \mapsto \int f(x_1, x_2) \dd \mu_1(x_1)\]
  is \(\mathcal{A}_2\)-measurable and,
  \[\int f \dd (\mu_1 \otimes \mu_2) = 
    \int \left(\int f \dd \mu_2\right) \dd \mu_1 = 
    \int \left(\int f \dd \mu_1\right) \dd \mu_2.\]
\end{theorem}

Towards proving Fubini's theorem, let us first prove the following
lemma.

\begin{lemma}
  If \(Q \in \mathcal{A} := \mathcal{A}_1 \otimes \mathcal{A}_2\) and 
  \(f : X_1 \times X_2 \to [-\infty, \infty]\) is \(\mathcal{A}\)-measurable. Then, 
  \[Q_{x_1} := \{x_2 \in X_2 \mid (x_1, x_2) \in Q\},\]
  and 
  \[f_{x_1} : X_2 \to [-\infty, \infty] : x_2 \mapsto f(x_1, x_2),\]
  are both \(\mathcal{A}_2\)-measurable for every \(x_1\). The symmetric statement 
  is also true.
\end{lemma}
\proof

Let
\(\mathcal{F} := \{Q \subseteq X_1 \times X_2 \mid Q_{x_1} \in \mathcal{A}_2, x_1 \in X_1\}\),
and it is not difficult to see that \(\mathcal{F}\) is a
\(\sigma\)-algebra on \(X_1 \times X_2\). Clearly
\(A_1 \times A_2 \in \mathcal{F}\) for all \(A_1 \in \mathcal{A}_1\) and
\(A_2 \in \mathcal{A}_2\) and thus,
\(\mathcal{A} \subseteq \mathcal{F}\) and the first result follows.
Furthermore, by fixing \(x_1 \in X\), \(U \subseteq \mathbb{R}\) open,
we have \(f^{-1}(U) \in \mathcal{A}\) and so
\(f_{x_1}^{-1}(U) = \{x_2 \mid f(x_1, x_2) \in U\}  = f^{-1}(U)_{x_1} \in \mathcal{A}_2\)
and hence \(f_{x_1}\) is \(\mathcal{A}_2\)-measurable. \qed

Next we show a special case of Fubini's theorem.

\begin{prop}\label{spe_fubini}
  If \(Q \in \mathcal{A}\), then \(x_1 \mapsto \mu_2(Q_{x_2})\) is 
  \(\mathcal{A}_1\)-measurable, \(x_2 \mapsto \mu_1(Q_{x_1})\) is 
  \(\mathcal{A}_2\)-measurable and 
  \[(\mu_1 \otimes \mu_2)(Q) = \int \mu_2(Q_{x_1}) \dd \mu_1(x_1) =  
    \int \mu_1(Q_{x_2}) \dd \mu_2(x_2).\]
\end{prop}

This proposition can be shown through a similar argument as above but,
instead of repeating ourselves, we shall introduce a useful result that
helps us with these types of proofs.

\begin{theorem}[Dynkin's \(\pi-\lambda\) Theorem]
  Let \(X\) be a set, \(P \subseteq \mathcal{P}(X)\) be closed under intersection, 
  (known as a \(\pi\)-system) and \(L \subseteq \mathcal{P}(X)\) contains 
  \(X\), closed under complements and closed under countable disjoint 
  unions (known as a \(\lambda\) system), then,
  \[P \subseteq L \implies \sigma(P) \subseteq L.\] 
\end{theorem}
\proof

Omitted. \qed

\proof (Proposition \ref{spe_fubini}).

First assume \(\mu_1, \mu_2\) are \(\sigma\)-finite and let
\[L := \{Q \in \mathcal{A} \mid \text{ the proposition holds.}\}\] and
\[P := \{ A_1 \times A_2 \mid A_1 \in \mathcal{A}_1, A_2 \in \mathcal{A}_2\}.\]
Clearly, \(P\) is a \(\pi\)-system, and so, it suffices to show that
\(L\) is a \(\lambda\)-system and \(P \subseteq L\). Indeed,
\(P \subseteq L\) since for all \(A_1 \times A_2 \in P\), we have
\[x_1 \mapsto \mu_2((A_1 \times A_2)_{x_1}) = \mu_2(A_2)\mathbf{1}_{A_1}(x),\]
and so, is measurable since \(A_1\) is. Furthermore,
\[(\mu_1 \otimes \mu_2)(A_1 \times A_2) = \mu_1(A_1) \mu_2(A_2) = 
    \int \mu_2(A_2)\mathbf{1}_{A_1} \dd \mu_1 = \int \mu_2(Q_{x_1}) \dd \mu_1(x_1),\]
and thus, \(P \subseteq L\).

Straight away \(X \in L\) since \(X = X_1 \times X_2 \in P\) so let us
show closure under complement and countable disjoint unions. Let
\(Q \in L\), then we have \((Q^c)_{x_1} = (Q_{x_1})^c\) we have
\(x_1 \mapsto \mu_2((Q^c)_{x_1}) = \mu_2(X_2) - \mu(Q_{x_1})\) which is
measurable and that \[\begin{split}
    \int \mu_2((Q^c)_{x_1}) \dd \mu_1(x_1) 
      & = \mu_1(X_1)\mu_2(X_2) - \int \mu_2(Q_{x_1}) \dd \mu_1(x_1)\\
      & = \mu_1(X_1)\mu_2(X_2) - (\mu_1 \otimes \mu_2)(Q) = (\mu_1 \otimes \mu_2)(Q^c).
  \end{split}\] Lastly, if \((Q_i) \subseteq L\) are disjoint, then
\(\bigcup Q_i \in \mathcal{A}\) follows using that
\((\bigcup Q_i)_{x_1} = \bigcup (Q_i)_{x_1}\) and \(\sigma\)-additivity
of \(\mu_1, \mu_2\) and \(\mu_1 \otimes \mu_2\).

In the case that \(\mu_1, \mu_2\) are \(\sigma\)-finite, one considers
an increasing sequence \(A_n^1 \times A_n^2 \in \mathcal{A}\) with
\(\mu_i(A_n^i) < \infty\). Then, the conclusion holds for
\((A_n^1 \times A_n^2) \cap Q\) by the above argument. Hence, the claim
follows by taking \(n \to \infty\) and using monotone convergence. \qed

\proof (Fubini's Theorem).

Let \(f = \mathbf{1}_Q\) for some \(Q \in \mathcal{A}\). Then
\(\mathbf{1}_Q(x_1, x_2) = \mathbf{1}_{Q_{x_1}}(x_2)\) for all
\(x_1, x_2\). Hence,
\[x_1 \mapsto \int f(x_1, x_2) \dd\mu_2(x_2) = \mu_2(Q_{x_1}),\] is
\(\mathcal{A}_1\)-measurable and the result follows by proposition
\ref{spe_fubini}. For \(f \ge 0\), we consider \(s_n \in S^+\) with
\(s_n \uparrow f\) which existence is provided by the approximation of
non-negative functions by simple functions. So, by monotone convergence
with respect to \(\mu_1\),
\[\int s_n(x_1, x_2) \dd \mu_2(x_2) \uparrow \int f(x_1, x_2) \dd \mu_2(x_2)\]
for all \(x_1 \in X_1\) and measurability follows by the measurability
of limits. Thus, \[\begin{split}
    \int f \dd (\mu_1 \otimes \mu_2) & = \lim_{n \to \infty} \int s_n \dd (\mu_1 \otimes \mu_2)\\
      & = \lim_{n \to \infty} \int \left(\int s_n(x_1, x_2 \dd\mu_2(x_2)) \right) \dd \mu_1(x_1)\\
      & = \int\left(\int f(x_1, x_2) \dd\mu_2(x_2)\right)\dd \mu_1(x_1).
  \end{split}\] Similar conclusion holds for \(f \in \mathcal{L}^1\) by
simply writing \(f = f^+ - f^-\). \qed

\newpage

\hypertarget{differentiation-of-measures}{%
\section{Differentiation of
Measures}\label{differentiation-of-measures}}

\hypertarget{differentiability-of-the-lebesgue-integral}{%
\subsection{Differentiability of the Lebesgue
Integral}\label{differentiability-of-the-lebesgue-integral}}

We shall in this section let \(\lambda\) be the Lebesgue measure on
\((\mathbb{R}^n, \mathcal{B}(\mathbb{R}^n))\) for \(n \ge 1\) and write
\(L^p(\mathbb{R}^n), p \ge 1\) for the corresponding \(L^p\)-spaces.

Suppose \(f : \mathbb{R} \to \mathbb{R}\) be continuous,
\(x_0 \in \mathbb{R}\) and \(F(x) := \int_{[x_0, x]} f \dd \lambda\).
Then, by the fundamental theorem of calculus (see problem sheet 5) we
have \(F\) is continuously differentiable and
\(F'(x) = \lim_{\epsilon \to 0} \epsilon^{-1} \int_{[x, x + \epsilon]} f \dd \lambda = f(x)\)
for all \(x \in \mathbb{R}\). Extending this into \(\mathbb{R}^n\), we
have if \(f \in C^\circ(\mathbb{R}^n)\), then
\[f(x) = \lim_{\epsilon \to 0} \frac{1}{\lambda(B_\epsilon(x))} \int_{B_\epsilon(x)} f \dd \lambda,\]
for all \(x \in \mathbb{R}^n\).

We ask whether this remains true in \(\mathbb{R}^n\) (\(\lambda\)-a.e.)
if we only assume \(f \in L_{loc}^1(\mathbb{R}^n)\)
(i.e.~\(f \in L^1(\Omega)\) for every bounded open set
\(\Omega \subseteq \mathbb{R}^n\)). This result turns out to be true and
the result is known as the Lebesgue's differentiation theorem.

\begin{theorem}[Lebesgue's differentiation theorem]
  Let \(f \in L_{loc}^1(\mathbb{R}^n)\). Then 
  \[f(x) = \lim_{r \to 0} \frac{1}{\lambda(B_r(x))} \int_{B_r(x)} f \dd \lambda,\]
  \(\lambda\)-a.e. \(x \in \mathbb{R}^n\).
\end{theorem}

In order to prove Lebesgue's differentiation theorem, let us introduce
the following function function.

\begin{definition}[Hardy-Littlewood Maximal Function]
  Given \(f \in L_{loc}^1(\mathbb{R}^n)\), the Hardy-Littlewood maximal function 
  of \(f\) is
  \[f^*(x) := \sup_{r > 0} \frac{1}{\lambda(B_r(x))} \int_{B_r(x)}|f| \dd\lambda.\]
\end{definition}

Since for each \(r > 0\), the function
\[x \mapsto \frac{1}{\lambda(B_r(x))} \int_{B_r(x)}|f| \dd\lambda,\] is
continuous, and hence measurable, we have the Hardy-Littlewood maximal
function is also measurable. On the other hand,
\(f^* \not\in L^1(\mathbb{R}^n)\) (unless \(\|f\|_{L^1} = 0\)). Indeed,
by choosing \(r_0 > 0\) such that
\(\int_{B_{r_0}} |f| \dd \lambda > c_1 > 0\), one obtains for
\(|x| > r_0\),
\[f^*(x) \ge \frac{1}{\lambda(B_{|x| + \epsilon}(x))}\int_{B_{|x| + \epsilon}(x)} |f| \dd \lambda \ge 
  \frac{1}{c(|x| + r_0)^n}c_1 \ge c' |x|^{-n}.\] But
\(|x|^{-n} \not\in L^1(\mathbb{R}^n)\), the result follows.

\begin{lemma}[Vitali's Covering Lemma]
  Let \(\mathcal{F}\) is a family of (Euclidean) balls in \(\mathbb{R}^n\) and 
  \[d_0 := \sup_{B \in \mathcal{F}} \text{diam} B < \infty.\]
  Then, there exists a countable family \(\mathcal{G} \subseteq \mathcal{F}\) 
  of disjoint balls such that 
  \[\bigcup_{B in \mathcal{F}} B \subseteq \bigcup_{B \in \mathcal{G}} \hat B,\]
  where we denote \(\hat B\) for the ball centred equal to \(B\) with 5 times the 
  diameter.
\end{lemma}
\proof

We define inductively maximal disjoint families
\(\mathcal{G}_i \subseteq \mathcal{F}\) as follows. For \(i = 1\) choose
\[\mathcal{G}_1 \subseteq \{B \in \mathcal{F} \mid \text{diam} > d_0 / 2 =: d_1\}\]
to be the maximal of such sets such that all balls in \(\mathcal{G}_i\)
are disjoint. Then, define
\[\mathcal{G}_{i + 1} \subseteq \{B \in \mathcal{F} \mid d_i \ge \text{diam} B > d_i / 2 
    =: d_{i + 1}, B \cap B' = \varnothing, \forall B' \in \mathcal{G}_1 \cup \cdots \cup 
    \mathcal{G}_i\},\] be the maximal. Then, define
\(\mathcal{G} := \bigcup_{i = 1}^\infty \mathcal{G}_i\). By
construction, \(\mathcal{G}\) consists of countably many pointwise
disjoint balls in \(\mathcal{F}\) so it remains to show that it covers.
Let \(B_0 \in \mathcal{F}\) and choose \(i \in \mathbb{N}\) such that
\(d_i < \text{diam} \le d_{i - 1}\). By maximality of \(\mathcal{G}_i\),
there exists \(B \in \mathcal{G}_1 \cup \cdots \cup  \mathcal{G}_i\)
with \(B \cap B_0 \neq \varnothing\). In particular,
\(\text{diam} B > d_i\) and since
\(\text{diam} B_0 \le d_{i - 1} = 2d_i\), it follows
\(\hat B \supseteq B\). \qed

\begin{prop}[Maximal Inequality]
  Let \(f \in L^1(\mathbb{R}^n)\). Then, for all \(a > 0\), 
  \[\lambda(\{x \in \mathbb{R}^n \mid f^*(x) > a\}) \le \frac{5^n}{a} \|f\|_{L^1}.\]
\end{prop}
\proof

Let \(A := \{x \in \mathbb{R}^n \mid f^*(x) > a\}\) for some given
\(a > 0\). By the definition of \(f^*\), for every \(x \in A\), there
exists \(r(x) > 0\), such that
\[\fint_{B_{r(x)}(x)} |f| \dd \lambda > a.\] In particular, letting
\(\omega_n = \lambda(B_1(0))\), we obtain for all \(x \in A\),
\[a \omega_n r(x)^n < a \lambda(B_{r(x)}(x)) < \int_{B_{r(x)}(x)} |f| \dd \lambda 
    \le \|f\|_{L^1},\] which implies a uniform upper bound on
\(\{r(x) \mid x \in A\}\),
\[\sup_{x \in A} r(x) \le (a^{-1} w_n^{-1} \|f\|_{L^1})^{1 / n} =: \frac{d_0}{2}.\]
Consider the family \(\mathcal{F} := \{B_{r(x)}(x) \mid x \in A\}\).
Clearly, \(A \subseteq \bigcup_{B \in \mathcal{F}} B\) and so, by
Vitali's covering lemma, there exists a countable family of pairwise
disjoint balls \(\mathcal{G} \subseteq \mathcal{F}\), such that
\(\bigcup_{B \in \mathcal{F}} B \subseteq \bigcup_{B \in \mathcal{G}} \hat B\).
Thus, we have
\[\lambda(A) \le \lambda \left(\bigcup_{B \in \mathcal{F}} B\right) 
  \le \lambda\left(\bigcup_{B \in \mathcal{G}} \hat B\right) \le 
  \sum_{B \in \mathcal{G}} \lambda(\hat B) = 5^n  \sum_{B \in \mathcal{G}} \lambda(B) 
  < 5^n \|f\|_{L^1}.\] \qed

This lemma can be generalised to any Radon measures \(\mu\) on
\(\mathbb{R}^n\) (\(\mu(K) < \infty\) for all compact
\(K \subseteq \mathbb{R}^n\)) satisfying a volume-doubling property,
i.e.~there exists some \(c \in (0, \infty)\) such that
\[\mu(B_{2r}(x)) \le c \mu(B_r(x)),\] for all
\(x \in \mathbb{R}^n, r > 0\).

\begin{lemma}
  Let \(C_c^\circ(\mathbb{R}^n) := \{f : \mathbb{R}^n \to \mathbb{R} \mid f 
    \text{ continuous and } \overline{\{x \mid f(x) \neq 0\}} \text{ is compact}\}\). 
  Then \(C_c^\circ(\mathbb{R}^n)\) is dense in \(L^1(\mathbb{R}^n)\), i.e. 
  for all \(f \in L^1(\mathbb{R}^n)\), there exists \((f_n) \subseteq C_c^\circ(\mathbb{R}^n)\) 
  such that \(f_n \to f\) in \(L^1\).
\end{lemma}
\proof

Consider the countable set of cubes \(C\), consisting of all dyadic
cubes \(Q = x + [0, 2^{-l})^n\) for some \(x \in 2^{-l} \mathbb{Z}^n\)
and \(l \in \mathbb{N}\). Define the set of functions
\[E := \left\{f = \sum_{k = 1}^N a_k \mathbf{1}_{Q_k} \mid 
    N \in \mathbb{N}, a_k \in \mathbb{Q}, Q_k \in C, \forall k = 1,\cdots, N\right\} 
    \subseteq L^1,\] and we will show that \(E\) is dense in
\(L^1(\mathbb{R}^n)\), i.e.~ for all \(f \in L^1(\mathbb{R}^n)\), there
exists a sequence \((f_k) \subseteq E\), such that
\(\|f - f_k\|_{L^1} \to 0\) as \(k \to \infty\) (in fact, since \(E\) is
countable, this would also mean that \(L^1(\mathbb{R}^n)\) is
separable). Indeed, if this is the case, for any cube \(Q \in C\), there
exist functions \(g_k \in C^\circ_c(\mathbb{R}^n)\) such that
\(g_k \to \mathbf{1}_Q\) in \(L^1\) and so, the result follows.

Wlog. we may assume that \(f \ge 0\) since we may simply write
\(f = f^+ - f^-\), resulting in our claim. Then, there exists a sequence
of measurable \((f_k) \subseteq S^+\) such that \(f_k \to f\) in
\(L^1\), and hence, it suffices to show the statement for simple
functions, that is,
\[\forall \epsilon > 0, A \in \mathcal{B}(\mathbb{R}^n), \lambda(A) < \infty, 
    \exists f \in E, \|f - \mathbf{1}_A\|_{L^1} < \epsilon.\] Let
\(\epsilon > 0\) and
\(A \in \mathcal{B}(\mathbb{R}^n), \lambda(A) < \infty\), applying the
approximation theorem, there exists some open set \(G \supseteq A\),
such that \(\lambda(G \setminus A) < \epsilon / 2\), whence,
\[\|\mathbf{1}_G - \mathbf{1}_A\|_{L^1} = \int |\mathbf{1}_G - \mathbf{1}_A| \dd \lambda 
  = \lambda(G \setminus A) < \frac{\epsilon}{2}.\] By a previous
construction, there exists a sequence \((Q_k) \subseteq C\), of disjoint
cubes such that \(G = \bigcup Q_k\). In particular,
\(f_k := \sum_{l = 1}^k \mathbf{1}_{Q_l} \in E\), and so by monotone
convergence,
\[\|\mathbf{1}_G - f_k\|_{L^1} \to 0 \text{ as } k \to \infty.\]
Finally, choosing \(k_0\) such that
\(\|\mathbf{1}_G - f_{k_0}\|_{L^1} < \epsilon / 2\), the result follows.
\qed

We note that we could in the proof also choose to approximate
\(\mathbf{1}_Q\) using functions in the space
\(C^\infty_c(\mathbb{R}^n)\) or other similar spaces resulting us to
find these spaces to also be dense in \(L^1(\mathbb{R}^n)\).

With that, we may prove Lebesgue's differentiation theorem.

\proof

Wlog. assume \(f \in L^1(\mathbb{R}^n)\) (else consider
\(f \mathbf{1}_{B_1(x)}\)). By the above lemma, there exists a sequence
\(C_c^\circ(\mathbb{R}^n)\), such that \(\|f_n - f\|_{L^1} \to 0\) as
\(n \to \infty\).

For shorthand, write
\(\fint_{B_r(x)} = \frac{1}{\lambda(B_r(x))}  \int_{B_r(x)}\) and we by
bound, \[\begin{split}
    & \limsup_{r \to 0} \left| \fint_{B_r(x)} f \dd \lambda - f(x) \right| \le 
      \limsup_{r \to 0} \fint_{B_r(x)} |f - f(x)| \dd \lambda\\
    & \le \limsup_{r \to 0} \fint_{B_r(x)} |f - f_n| \dd \lambda + 
      \limsup_{r \to 0} \fint_{B_r(x)} |f_n - f_n(x)| \dd \lambda + |f_n(x) - f(x)|\\
    & \le (f - f_n)^*(x) + |f_n(x) - f(x)|,
  \end{split}\] for all \(n \in \mathbb{N}\) and \(x \in \mathbb{R}^n\),
where the second term in the second line vanishes since \(f_n\) is
continuous. Thus, for all \(\epsilon > 0\), we obtain \[\begin{split}
    A_\epsilon & := \left\{x \in \mathbb{R}^n \mid \limsup_{r \to 0} 
      \fint_{B_r(x)} |f - f(x)| \dd \lambda > 2 \epsilon\right\} \\
      & \subseteq \{x \in \mathbb{R}^n \mid (f - f_n)^*(x) > \epsilon\} 
        \cup \{x \in \mathbb{R}^n \mid |f_n(x) - f(x)| > \epsilon\}
  \end{split}\] for all \(n \in \mathbb{N}\). Hence, by applying the
maximal inequality and Markov's inequality, it follows that
\[\lambda(A_\epsilon) \le \frac{c}{\epsilon} \|f - f_n\|_{L^1} 
    + \frac{1}{\epsilon} \|f - f_n\|_{L^1} \to 0,\] as \(n \to \infty\).
Thus, \(\lambda(A_\epsilon) = 0\) and the set
\[A := \left\{x \in \mathbb{R}^n \mid \limsup_{r \to 0} \fint_{B_r(x)} |f - f(x)| > 0 \right\} 
    = \bigcup_{k = 1}^\infty A_{\frac{1}{k}},\] is also a
\(\lambda\)-null-set, i.e.~\(\lambda(A) = 0\). Finally,
\[\left| f(x) - \lim_{r \to 0} \fint_{B_r(x)} f \dd \lambda \right|
    \le \lim_{r \to 0} \fint_{B_r(x)} |f - f(x)| \dd \lambda = 0\] holds
for \(\lambda\)-a.e. \(x \in \mathbb{R}^n\). \qed

We note that we have actually proved the following stronger statement in
which the Lebesgue's differentiation theorem follows by simple
application of the triangle inequality. If
\(f \in L_{loc}^1(\mathbb{R}^n)\), then for \(\lambda\)-a.e.
\(x \in \mathbb{R}^n\),
\[\lim_{r \to 0} \fint_{B_r(x)} |f - f(x)| \dd \lambda = 0,\] and points
satisfying this equality are called \textbf{Lebesgue-points} of \(f\).

\end{document}
